<!DOCTYPE html>





<html class="theme-next mist use-motion" lang="">
<head>
  <meta charset="UTF-8">
<meta name="generator" content="Hexo 3.9.0">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=7.3.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=7.3.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=7.3.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.3.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.3.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/ilyabirman-likely@2/release/likely.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '7.3.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    save_scroll: false,
    copycode: {"enable":true,"show_result":false,"style":null},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":3,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    }
  };
</script>

  <meta name="description" content="178. Combine Two Tablesn Easy1234567891011121314151617181920Table: Person+-------------+---------+      | Column Name | Type    |+-------------+---------+| PersonId    | int     || FirstName   | varch">
<meta name="keywords" content="SQL, Leetcode, Database">
<meta property="og:type" content="article">
<meta property="og:title" content="Leetcode SQL Summary">
<meta property="og:url" content="http://yoursite.com/2019/08/06/leetcodSQL/index.html">
<meta property="og:site_name" content="Shuo&#39;s Blog">
<meta property="og:description" content="178. Combine Two Tablesn Easy1234567891011121314151617181920Table: Person+-------------+---------+      | Column Name | Type    |+-------------+---------+| PersonId    | int     || FirstName   | varch">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-09-04T23:49:08.143Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Leetcode SQL Summary">
<meta name="twitter:description" content="178. Combine Two Tablesn Easy1234567891011121314151617181920Table: Person+-------------+---------+      | Column Name | Type    |+-------------+---------+| PersonId    | int     || FirstName   | varch">
  <link rel="canonical" href="http://yoursite.com/2019/08/06/leetcodSQL/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>Leetcode SQL Summary | Shuo's Blog</title>
  








  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  <div class="container sidebar-position-left">
    <div class="headband"></div>
    <a href="https://github.com/AdadaBdada" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Shuo's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-about">
      
    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
      </li>
    
  </ul>

    

</nav>
  <div class="site-search">
    
  <div class="popup search-popup">
  <div class="search-header">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <div class="search-input-wrapper">
      <input autocomplete="off" autocorrect="off" autocapitalize="none"
             placeholder="Searching..." spellcheck="false"
             type="text" id="search-input">
    </div>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>
  <div id="search-result"></div>
</div>


  </div>
</div>
    </header>


    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content page-post-detail">
            

  <div id="posts" class="posts-expand">
    

  <article class="post" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/08/06/leetcodSQL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Shuo Jin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shuo's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">Leetcode SQL Summary

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2019-08-06 12:43:35" itemprop="dateCreated datePublished" datetime="2019-08-06T12:43:35-07:00">2019-08-06</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-09-04 16:49:08" itemprop="dateModified" datetime="2019-09-04T16:49:08-07:00">2019-09-04</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Leetcode/" itemprop="url" rel="index"><span itemprop="name">Leetcode</span></a></span>

                
                
              
            </span>
          

          
            <span class="post-meta-item" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          
          <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
              
                <span class="post-meta-item-text">Symbols count in article: </span>
              
              <span>40k</span>
            </span>
          
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
              
                <span class="post-meta-item-text">Reading time &asymp;</span>
              
              <span>36 mins.</span>
            </span>
          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="178-Combine-Two-Tablesn-Easy"><a href="#178-Combine-Two-Tablesn-Easy" class="headerlink" title="178. Combine Two Tablesn Easy"></a>178. Combine Two Tablesn Easy</h1><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Table: Person</span><br><span class="line"><span class="code">+-------------+</span>---------+      </span><br><span class="line">| Column Name | Type    |</span><br><span class="line"><span class="code">+-------------+</span>---------+</span><br><span class="line">| PersonId    | int     |</span><br><span class="line">| FirstName   | varchar |</span><br><span class="line">| LastName    | varchar |</span><br><span class="line"><span class="code">+-------------+</span>---------+</span><br><span class="line">PersonId is the primary key column for this table.<span class="strong">*/</span></span><br><span class="line"><span class="strong"></span></span><br><span class="line"><span class="strong">Table: Address</span></span><br><span class="line"><span class="strong">+-------------+---------+</span></span><br><span class="line"><span class="strong">| Column Name | Type    |</span></span><br><span class="line"><span class="strong">+-------------+---------+</span></span><br><span class="line"><span class="strong">| AddressId   | int     |</span></span><br><span class="line"><span class="strong">| PersonId    | int     |</span></span><br><span class="line"><span class="strong">| City        | varchar |</span></span><br><span class="line"><span class="strong">| State       | varchar |</span></span><br><span class="line"><span class="strong">+-------------+---------+</span></span><br><span class="line"><span class="strong">AddressId is the primary key column for this table.</span></span><br></pre></td></tr></table></figure>

<a id="more"></a>
<p>Write a SQL query for a report that provides the following information for each person in the Person table, regardless if there is an address for each of those people:</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">FirstName,</span> LastName, City, State</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> p.FirstName, p.LastName, a.City, a.State</span><br><span class="line">  <span class="keyword">FROM</span> Person p</span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Address a</span><br><span class="line">    <span class="keyword">ON</span> p.PersonId = a.PersonId</span><br></pre></td></tr></table></figure>

<h1 id="176-Second-Highest-Salary"><a href="#176-Second-Highest-Salary" class="headerlink" title="176. Second Highest Salary"></a>176. Second Highest Salary</h1><p>Write a SQL query to get the second highest salary from the <code>Employee</code> table.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----+</span>--------+</span><br><span class="line">| Id | Salary |</span><br><span class="line"><span class="code">+----+</span>--------+</span><br><span class="line">| 1  | 100    |</span><br><span class="line">| 2  | 200    |</span><br><span class="line">| 3  | 300    |</span><br><span class="line"><span class="code">+----+</span>--------+</span><br></pre></td></tr></table></figure>

<p>For example, given the above Employee table, the query should return <code>200</code> as the second highest salary. If there is no second highest salary, then the query should return <code>null</code>.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+---------------------+</span></span><br><span class="line">| SecondHighestSalary |</span><br><span class="line"><span class="code">+---------------------+</span></span><br><span class="line">| 200                 |</span><br><span class="line"><span class="code">+---------------------+</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(Salary) <span class="keyword">AS</span> SecondHighestSalary</span><br><span class="line">  <span class="keyword">FROM</span> Employee</span><br><span class="line"> <span class="keyword">WHERE</span> Salary &lt; (<span class="keyword">SELECT</span> <span class="keyword">MAX</span>(Salary)</span><br><span class="line">                   <span class="keyword">FROM</span> Employee);</span><br></pre></td></tr></table></figure>

<h1 id="177-Nth-Highest-Salary"><a href="#177-Nth-Highest-Salary" class="headerlink" title="177. Nth Highest Salary"></a>177. Nth Highest Salary</h1><p>Write a SQL query to get the $n^{th}$ highest salary from the <code>Employee</code> table.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----+</span>--------+</span><br><span class="line">| Id | Salary |</span><br><span class="line"><span class="code">+----+</span>--------+</span><br><span class="line">| 1  | 100    |</span><br><span class="line">| 2  | 200    |</span><br><span class="line">| 3  | 300    |</span><br><span class="line"><span class="code">+----+</span>--------+</span><br></pre></td></tr></table></figure>

<p>For example, given the above Employee table, the nth highest salary where $n = 2$ is <code>200</code>. If there is no nth highest salary, then the query should return <code>null</code>.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+------------------------+</span></span><br><span class="line">| getNthHighestSalary(2) |</span><br><span class="line"><span class="code">+------------------------+</span></span><br><span class="line">| 200                    |</span><br><span class="line"><span class="code">+------------------------+</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> getNthHighestSalary(N <span class="built_in">INT</span>) <span class="keyword">RETURNS</span> <span class="built_in">INT</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">SET</span> N = N<span class="number">-1</span>;</span><br><span class="line">  RETURN (</span><br><span class="line">      <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> Salary</span><br><span class="line">        <span class="keyword">FROM</span> Employee</span><br><span class="line">       <span class="keyword">ORDER</span> <span class="keyword">BY</span> Salary <span class="keyword">DESC</span></span><br><span class="line">       <span class="keyword">LIMIT</span> <span class="number">1</span> <span class="keyword">OFFSET</span> N);</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure>

<h1 id="178-Rank-Scores"><a href="#178-Rank-Scores" class="headerlink" title="178. Rank Scores"></a>178. Rank Scores</h1><p>Write a SQL query to rank scores. If there is a tie between two scores, both should have the same ranking. Note that after a tie, the next ranking number should be the next consecutive integer value. In other words, there should be no “holes” between ranks.</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+----+-------+</span><br><span class="line">|<span class="string"> Id </span>|<span class="string"> Score </span>|</span><br><span class="line">+----+-------+</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> 3.50  </span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string"> 3.65  </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> 4.00  </span>|</span><br><span class="line">|<span class="string"> 4  </span>|<span class="string"> 3.85  </span>|</span><br><span class="line">|<span class="string"> 5  </span>|<span class="string"> 4.00  </span>|</span><br><span class="line">|<span class="string"> 6  </span>|<span class="string"> 3.65  </span>|</span><br><span class="line">+----+-------+</span><br></pre></td></tr></table></figure>

<p>For example, given the above <code>Scores</code> table, your query should generate the following report (order by highest score):</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+-------+------+</span><br><span class="line">|<span class="string"> Score </span>|<span class="string"> Rank </span>|</span><br><span class="line">+-------+------+</span><br><span class="line">|<span class="string"> 4.00  </span>|<span class="string"> 1    </span>|</span><br><span class="line">|<span class="string"> 4.00  </span>|<span class="string"> 1    </span>|</span><br><span class="line">|<span class="string"> 3.85  </span>|<span class="string"> 2    </span>|</span><br><span class="line">|<span class="string"> 3.65  </span>|<span class="string"> 3    </span>|</span><br><span class="line">|<span class="string"> 3.65  </span>|<span class="string"> 3    </span>|</span><br><span class="line">|<span class="string"> 3.50  </span>|<span class="string"> 4    </span>|</span><br><span class="line">+-------+------+</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Score,</span><br><span class="line">       <span class="keyword">DENSE_RANK</span>() <span class="keyword">OVER</span> (<span class="keyword">ORDER</span> <span class="keyword">BY</span> Score <span class="keyword">DESC</span>) <span class="keyword">AS</span> <span class="keyword">Rank</span></span><br><span class="line">  <span class="keyword">FROM</span> Scores;</span><br></pre></td></tr></table></figure>

<h1 id="180-Consecutive-Numbers"><a href="#180-Consecutive-Numbers" class="headerlink" title="180. Consecutive Numbers"></a>180. Consecutive Numbers</h1><p>Write a SQL query to find all numbers that appear at least three times consecutively.</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+----+-----+</span><br><span class="line">|<span class="string"> Id </span>|<span class="string"> Num </span>|</span><br><span class="line">+----+-----+</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string">  1  </span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string">  1  </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string">  1  </span>|</span><br><span class="line">|<span class="string"> 4  </span>|<span class="string">  2  </span>|</span><br><span class="line">|<span class="string"> 5  </span>|<span class="string">  1  </span>|</span><br><span class="line">|<span class="string"> 6  </span>|<span class="string">  2  </span>|</span><br><span class="line">|<span class="string"> 7  </span>|<span class="string">  2  </span>|</span><br><span class="line">+----+-----+</span><br></pre></td></tr></table></figure>

<p>For example, given the above <code>Logs</code> table, 1 is the only number that appears consecutively for at least three times.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+-----------------+</span></span><br><span class="line">| ConsecutiveNums |</span><br><span class="line"><span class="code">+-----------------+</span></span><br><span class="line">| 1               |</span><br><span class="line"><span class="code">+-----------------+</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> l1.Num <span class="keyword">AS</span> ConsecutiveNums</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">Logs</span> l1,</span><br><span class="line">     <span class="keyword">Logs</span> l2,</span><br><span class="line">     <span class="keyword">Logs</span> l3</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">    l1.Id = l2.Id <span class="number">-1</span></span><br><span class="line">    <span class="keyword">AND</span> l2.Id = l3.Id - <span class="number">1</span></span><br><span class="line">    <span class="keyword">AND</span> l1.Num = l2.Num</span><br><span class="line">    <span class="keyword">AND</span> l2.Num = l3.Num</span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<h1 id="181-Employees-Earning-More-Than-Their-Managers"><a href="#181-Employees-Earning-More-Than-Their-Managers" class="headerlink" title="181. Employees Earning More Than Their Managers"></a>181. Employees Earning More Than Their Managers</h1><p>The <code>Employee</code> table holds all employees including their managers. Every employee has an Id, and there is also a column for the manager Id.</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+----+-------+--------+-----------+</span><br><span class="line">|<span class="string"> Id </span>|<span class="string"> Name  </span>|<span class="string"> Salary </span>|<span class="string"> ManagerId </span>|</span><br><span class="line">+----+-------+--------+-----------+</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> Joe   </span>|<span class="string"> 70000  </span>|<span class="string"> 3         </span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string"> Henry </span>|<span class="string"> 80000  </span>|<span class="string"> 4         </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> Sam   </span>|<span class="string"> 60000  </span>|<span class="string"> NULL      </span>|</span><br><span class="line">|<span class="string"> 4  </span>|<span class="string"> Max   </span>|<span class="string"> 90000  </span>|<span class="string"> NULL      </span>|</span><br><span class="line">+----+-------+--------+-----------+</span><br></pre></td></tr></table></figure>

<p>Given the <code>Employee</code> table, write a SQL query that finds out employees who earn more than their managers. For the above table, Joe is the only employee who earns more than his manager.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----------+</span></span><br><span class="line">| Employee |</span><br><span class="line"><span class="code">+----------+</span></span><br><span class="line">| Joe      |</span><br><span class="line"><span class="code">+----------+</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> Employee <span class="keyword">AS</span> a <span class="keyword">JOIN</span> Employee <span class="keyword">AS</span> b</span><br><span class="line">     <span class="keyword">ON</span> a.ManagerId = b.Id</span><br><span class="line">     <span class="keyword">AND</span> a.Salary &gt; b.Salary</span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<h1 id="182-Duplicate-Emails"><a href="#182-Duplicate-Emails" class="headerlink" title="182. Duplicate Emails"></a>182. Duplicate Emails</h1><p>Write a SQL query to find all duplicate emails in a table named <code>Person</code>.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----+</span>---------+</span><br><span class="line">| Id | Email   |</span><br><span class="line"><span class="code">+----+</span>---------+</span><br><span class="line">| 1  | a@b.com |</span><br><span class="line">| 2  | c@d.com |</span><br><span class="line">| 3  | a@b.com |</span><br><span class="line"><span class="code">+----+</span>---------+</span><br></pre></td></tr></table></figure>

<p>For example, your query should return the following for the above table:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+---------+</span></span><br><span class="line">| Email   |</span><br><span class="line"><span class="code">+---------+</span></span><br><span class="line">| a@b.com |</span><br><span class="line"><span class="code">+---------+</span></span><br></pre></td></tr></table></figure>

<p><strong>Note</strong>: All emails are in lowercase.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Email</span><br><span class="line">  <span class="keyword">FROM</span> Person</span><br><span class="line"> <span class="keyword">GROUP</span> <span class="keyword">BY</span> Email</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(Email) &gt; <span class="number">1</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<h1 id="183-Customers-Who-Never-Order"><a href="#183-Customers-Who-Never-Order" class="headerlink" title="183. Customers Who Never Order"></a>183. Customers Who Never Order</h1><p>Suppose that a website contains two tables, the <code>Customers</code> table and the <code>Orders</code> table. Write a SQL query to find all customers who never order anything.</p>
<p>Table: <code>Customers</code>.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----+</span>-------+</span><br><span class="line">| Id | Name  |</span><br><span class="line"><span class="code">+----+</span>-------+</span><br><span class="line">| 1  | Joe   |</span><br><span class="line">| 2  | Henry |</span><br><span class="line">| 3  | Sam   |</span><br><span class="line">| 4  | Max   |</span><br><span class="line"><span class="code">+----+</span>-------+</span><br></pre></td></tr></table></figure>

<p>Table: <code>Orders</code>.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----+</span>------------+</span><br><span class="line">| Id | CustomerId |</span><br><span class="line"><span class="code">+----+</span>------------+</span><br><span class="line">| 1  | 3          |</span><br><span class="line">| 2  | 1          |</span><br><span class="line"><span class="code">+----+</span>------------+</span><br></pre></td></tr></table></figure>

<p>Using the above tables as example, return the following:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+-----------+</span></span><br><span class="line">| Customers |</span><br><span class="line"><span class="code">+-----------+</span></span><br><span class="line">| Henry     |</span><br><span class="line">| Max       |</span><br><span class="line"><span class="code">+-----------+</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">Name</span> <span class="keyword">AS</span> Customers</span><br><span class="line">  <span class="keyword">FROM</span> Customers</span><br><span class="line"> <span class="keyword">WHERE</span> <span class="keyword">Id</span> <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> CustomerId <span class="keyword">FROM</span> Orders);</span><br></pre></td></tr></table></figure>

<h1 id="184-Department-Highest-Salary"><a href="#184-Department-Highest-Salary" class="headerlink" title="184. Department Highest Salary"></a>184. Department Highest Salary</h1><p>The <code>Employee</code> table holds all employees. Every employee has an Id, a salary, and there is also a column for the department Id.</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+----+-------+--------+--------------+</span><br><span class="line">|<span class="string"> Id </span>|<span class="string"> Name  </span>|<span class="string"> Salary </span>|<span class="string"> DepartmentId </span>|</span><br><span class="line">+----+-------+--------+--------------+</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> Joe   </span>|<span class="string"> 70000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string"> Jim   </span>|<span class="string"> 90000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> Henry </span>|<span class="string"> 80000  </span>|<span class="string"> 2            </span>|</span><br><span class="line">|<span class="string"> 4  </span>|<span class="string"> Sam   </span>|<span class="string"> 60000  </span>|<span class="string"> 2            </span>|</span><br><span class="line">|<span class="string"> 5  </span>|<span class="string"> Max   </span>|<span class="string"> 90000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">+----+-------+--------+--------------+</span><br></pre></td></tr></table></figure>

<p>The <code>Department</code> table holds all departments of the company.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----+</span>----------+</span><br><span class="line">| Id | Name     |</span><br><span class="line"><span class="code">+----+</span>----------+</span><br><span class="line">| 1  | IT       |</span><br><span class="line">| 2  | Sales    |</span><br><span class="line"><span class="code">+----+</span>----------+</span><br></pre></td></tr></table></figure>

<p>Write a SQL query to find employees who have the highest salary in each of the departments. For the above tables, your SQL query should return the following rows (order of rows does not matter).</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+------------+</span>----------<span class="code">+--------+</span></span><br><span class="line">| Department | Employee | Salary |</span><br><span class="line"><span class="code">+------------+</span>----------<span class="code">+--------+</span></span><br><span class="line">| IT         | Max      | 90000  |</span><br><span class="line">| IT         | Jim      | 90000  |</span><br><span class="line">| Sales      | Henry    | 80000  |</span><br><span class="line"><span class="code">+------------+</span>----------<span class="code">+--------+</span></span><br></pre></td></tr></table></figure>

<p><strong>Explanation</strong>:</p>
<p>Max and Jim both have the highest salary in the IT department and Henry has the highest salary in the Sales department.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">      d.Name <span class="keyword">AS</span> Department,</span><br><span class="line">      e.Name <span class="keyword">AS</span> Employee,</span><br><span class="line">      Salary</span><br><span class="line"> <span class="keyword">FROM</span> Employee e</span><br><span class="line"> <span class="keyword">JOIN</span> Department d</span><br><span class="line">   <span class="keyword">ON</span> e.DepartmentId = d.Id</span><br><span class="line"><span class="keyword">WHERE</span> (DepartmentId,Salary) <span class="keyword">IN</span></span><br><span class="line">      (<span class="keyword">SELECT</span> DepartmentId, <span class="keyword">MAX</span>(Salary)</span><br><span class="line">         <span class="keyword">FROM</span> Employee</span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span> DepartmentId)</span><br></pre></td></tr></table></figure>

<h1 id="185-Department-Top-Three-Salaries"><a href="#185-Department-Top-Three-Salaries" class="headerlink" title="185. Department Top Three Salaries"></a>185. Department Top Three Salaries</h1><p>The <code>Employee</code> table holds all employees. Every employee has an Id, and there is also a column for the department Id.</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+----+-------+--------+--------------+</span><br><span class="line">|<span class="string"> Id </span>|<span class="string"> Name  </span>|<span class="string"> Salary </span>|<span class="string"> DepartmentId </span>|</span><br><span class="line">+----+-------+--------+--------------+</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> Joe   </span>|<span class="string"> 85000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string"> Henry </span>|<span class="string"> 80000  </span>|<span class="string"> 2            </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> Sam   </span>|<span class="string"> 60000  </span>|<span class="string"> 2            </span>|</span><br><span class="line">|<span class="string"> 4  </span>|<span class="string"> Max   </span>|<span class="string"> 90000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">|<span class="string"> 5  </span>|<span class="string"> Janet </span>|<span class="string"> 69000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">|<span class="string"> 6  </span>|<span class="string"> Randy </span>|<span class="string"> 85000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">|<span class="string"> 7  </span>|<span class="string"> Will  </span>|<span class="string"> 70000  </span>|<span class="string"> 1            </span>|</span><br><span class="line">+----+-------+--------+--------------+</span><br></pre></td></tr></table></figure>

<p>The <code>Department</code> table holds all departments of the company.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----+</span>----------+</span><br><span class="line">| Id | Name     |</span><br><span class="line"><span class="code">+----+</span>----------+</span><br><span class="line">| 1  | IT       |</span><br><span class="line">| 2  | Sales    |</span><br><span class="line"><span class="code">+----+</span>----------+</span><br></pre></td></tr></table></figure>

<p>Write a SQL query to find employees who earn the top three salaries in each of the department. For the above tables, your SQL query should return the following rows (order of rows does not matter).</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+------------+----------+--------+</span><br><span class="line">|<span class="string"> Department </span>|<span class="string"> Employee </span>|<span class="string"> Salary </span>|</span><br><span class="line">+------------+----------+--------+</span><br><span class="line">|<span class="string"> IT         </span>|<span class="string"> Max      </span>|<span class="string"> 90000  </span>|</span><br><span class="line">|<span class="string"> IT         </span>|<span class="string"> Randy    </span>|<span class="string"> 85000  </span>|</span><br><span class="line">|<span class="string"> IT         </span>|<span class="string"> Joe      </span>|<span class="string"> 85000  </span>|</span><br><span class="line">|<span class="string"> IT         </span>|<span class="string"> Will     </span>|<span class="string"> 70000  </span>|</span><br><span class="line">|<span class="string"> Sales      </span>|<span class="string"> Henry    </span>|<span class="string"> 80000  </span>|</span><br><span class="line">|<span class="string"> Sales      </span>|<span class="string"> Sam      </span>|<span class="string"> 60000  </span>|</span><br><span class="line">+------------+----------+--------+</span><br></pre></td></tr></table></figure>

<p>MS SQL Server Solution</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Department.Name <span class="keyword">AS</span> Department,</span><br><span class="line">       temp.Name <span class="keyword">AS</span> Employee,</span><br><span class="line">       temp.Salary</span><br><span class="line">  <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> *,</span><br><span class="line">               <span class="keyword">DENSE_RANk</span>() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> DepartmentId</span><br><span class="line">                    <span class="keyword">BY</span> Salary <span class="keyword">DESC</span>)</span><br><span class="line">                <span class="keyword">AS</span> <span class="keyword">rank</span></span><br><span class="line">        <span class="keyword">FROM</span> Employee) temp</span><br><span class="line">  <span class="keyword">JOIN</span> Department</span><br><span class="line">    <span class="keyword">ON</span> Department.ID = temp.DepartmentId</span><br><span class="line"> <span class="keyword">WHERE</span> <span class="keyword">rank</span> &lt; <span class="number">4</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<h1 id="196-Delete-Duplicate-Emails"><a href="#196-Delete-Duplicate-Emails" class="headerlink" title="196. Delete Duplicate Emails"></a>196. Delete Duplicate Emails</h1><p>Write a SQL query to <strong>delete</strong> all duplicate email entries in a table named <code>Person</code>, keeping only unique emails based on its <em>smallest</em> <strong>Id</strong>.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----+</span>------------------+</span><br><span class="line">| Id | Email            |</span><br><span class="line"><span class="code">+----+</span>------------------+</span><br><span class="line">| 1  | john@example.com |</span><br><span class="line">| 2  | bob@example.com  |</span><br><span class="line">| 3  | john@example.com |</span><br><span class="line"><span class="code">+----+</span>------------------+</span><br><span class="line">Id is the primary key column for this table.</span><br></pre></td></tr></table></figure>

<p>For example, after running your query, the above Person table should have the following rows:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----+</span>------------------+</span><br><span class="line">| Id | Email            |</span><br><span class="line"><span class="code">+----+</span>------------------+</span><br><span class="line">| 1  | john@example.com |</span><br><span class="line">| 2  | bob@example.com  |</span><br><span class="line"><span class="code">+----+</span>------------------+</span><br></pre></td></tr></table></figure>

<p><strong>Note</strong>:</p>
<p>Your output is the whole <code>Person</code> table after executing your sql. Use delete statement.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> p1</span><br><span class="line">  <span class="keyword">FROM</span> Person p1,Person p2</span><br><span class="line"> <span class="keyword">WHERE</span> p1.Email = p2.Email <span class="keyword">AND</span> p1.Id &gt; p2.Id</span><br></pre></td></tr></table></figure>

<h1 id="197-Rising-Temperature"><a href="#197-Rising-Temperature" class="headerlink" title="197. Rising Temperature"></a>197. Rising Temperature</h1><p>Given a <code>Weather</code> table, write a SQL query to find all dates’ Ids with higher temperature compared to its previous (yesterday’s) dates.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+---------+</span>------------------<span class="code">+------------------+</span></span><br><span class="line">| Id(INT) | RecordDate(DATE) | Temperature(INT) |</span><br><span class="line"><span class="code">+---------+</span>------------------<span class="code">+------------------+</span></span><br><span class="line">|       1 |       2015-01-01 |               10 |</span><br><span class="line">|       2 |       2015-01-02 |               25 |</span><br><span class="line">|       3 |       2015-01-03 |               20 |</span><br><span class="line">|       4 |       2015-01-04 |               30 |</span><br><span class="line"><span class="code">+---------+</span>------------------<span class="code">+------------------+</span></span><br></pre></td></tr></table></figure>

<p>For example, return the following Ids for the above <code>Weather</code> table:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+----+</span></span><br><span class="line">| Id |</span><br><span class="line"><span class="code">+----+</span></span><br><span class="line">|  2 |</span><br><span class="line">|  4 |</span><br><span class="line"><span class="code">+----+</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> w2.Id</span><br><span class="line">  <span class="keyword">FROM</span> Weather w1, Weather w2</span><br><span class="line"> <span class="keyword">WHERE</span> <span class="keyword">DATEDIFF</span>(w2.RecordDate, w1.RecordDate)=<span class="number">1</span></span><br><span class="line">       <span class="keyword">AND</span> w1.Temperature &lt; w2.Temperature</span><br></pre></td></tr></table></figure>

<h1 id="262-Trips-and-Users"><a href="#262-Trips-and-Users" class="headerlink" title="262. Trips and Users"></a>262. Trips and Users</h1><p>The <code>Trips</code> table holds all taxi trips. Each trip has a unique Id, while Client_Id and Driver_Id are both foreign keys to the Users_Id at the <code>Users</code> table. Status is an ENUM type of (‘completed’, ‘cancelled_by_driver’, ‘cancelled_by_client’).</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">+----+-----------+-----------+---------+--------------------+----------+</span><br><span class="line">|<span class="string"> Id </span>|<span class="string"> Client_Id </span>|<span class="string"> Driver_Id </span>|<span class="string"> City_Id </span>|<span class="string">        Status      </span>|<span class="string">Request_at</span>|</span><br><span class="line">+----+-----------+-----------+---------+--------------------+----------+</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string">     1     </span>|<span class="string">    10     </span>|<span class="string">    1    </span>|<span class="string">     completed      </span>|<span class="string">2013-10-01</span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string">     2     </span>|<span class="string">    11     </span>|<span class="string">    1    </span>|<span class="string"> cancelled_by_driver</span>|<span class="string">2013-10-01</span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string">     3     </span>|<span class="string">    12     </span>|<span class="string">    6    </span>|<span class="string">     completed      </span>|<span class="string">2013-10-01</span>|</span><br><span class="line">|<span class="string"> 4  </span>|<span class="string">     4     </span>|<span class="string">    13     </span>|<span class="string">    6    </span>|<span class="string"> cancelled_by_client</span>|<span class="string">2013-10-01</span>|</span><br><span class="line">|<span class="string"> 5  </span>|<span class="string">     1     </span>|<span class="string">    10     </span>|<span class="string">    1    </span>|<span class="string">     completed      </span>|<span class="string">2013-10-02</span>|</span><br><span class="line">|<span class="string"> 6  </span>|<span class="string">     2     </span>|<span class="string">    11     </span>|<span class="string">    6    </span>|<span class="string">     completed      </span>|<span class="string">2013-10-02</span>|</span><br><span class="line">|<span class="string"> 7  </span>|<span class="string">     3     </span>|<span class="string">    12     </span>|<span class="string">    6    </span>|<span class="string">     completed      </span>|<span class="string">2013-10-02</span>|</span><br><span class="line">|<span class="string"> 8  </span>|<span class="string">     2     </span>|<span class="string">    12     </span>|<span class="string">    12   </span>|<span class="string">     completed      </span>|<span class="string">2013-10-03</span>|</span><br><span class="line">|<span class="string"> 9  </span>|<span class="string">     3     </span>|<span class="string">    10     </span>|<span class="string">    12   </span>|<span class="string">     completed      </span>|<span class="string">2013-10-03</span>|</span><br><span class="line">|<span class="string"> 10 </span>|<span class="string">     4     </span>|<span class="string">    13     </span>|<span class="string">    12   </span>|<span class="string"> cancelled_by_driver</span>|<span class="string">2013-10-03</span>|</span><br><span class="line">+----+-----------+-----------+---------+--------------------+----------+</span><br></pre></td></tr></table></figure>

<p>The <code>Users</code> table holds all users. Each user has an unique Users_Id, and Role is an ENUM type of (‘client’, ‘driver’, ‘partner’).</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">+----------+--------+--------+</span><br><span class="line">| Users_Id | Banned |  Role  |</span><br><span class="line">+----------+--------+--------+</span><br><span class="line">|    1     |   <span class="literal">No</span>   |<span class="built_in"> client </span>|</span><br><span class="line">|    2     |   <span class="literal">Yes</span>  |<span class="built_in"> client </span>|</span><br><span class="line">|    3     |   <span class="literal">No</span>   |<span class="built_in"> client </span>|</span><br><span class="line">|    4     |   <span class="literal">No</span>   |<span class="built_in"> client </span>|</span><br><span class="line">|    10    |   <span class="literal">No</span>   | driver |</span><br><span class="line">|    11    |   <span class="literal">No</span>   | driver |</span><br><span class="line">|    12    |   <span class="literal">No</span>   | driver |</span><br><span class="line">|    13    |   <span class="literal">No</span>   | driver |</span><br><span class="line">+----------+--------+--------+</span><br></pre></td></tr></table></figure>

<p>Write a SQL query to find the cancellation rate of requests made by unbanned users (both client and driver must be unbanned) between Oct 1, 2013 and Oct 3, 2013. The cancellation rate is computed by dividing the number of canceled (by client or driver) requests made by unbanned users by the total number of requests made by unbanned users.</p>
<p>For the above tables, your SQL query should return the following rows with the cancellation rate being rounded to two decimal places.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+------------+</span>-------------------+</span><br><span class="line">|     Day    | Cancellation Rate |</span><br><span class="line"><span class="code">+------------+</span>-------------------+</span><br><span class="line">| 2013-10-01 |       0.33        |</span><br><span class="line">| 2013-10-02 |       0.00        |</span><br><span class="line">| 2013-10-03 |       0.50        |</span><br><span class="line"><span class="code">+------------+</span>-------------------+</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Request_at <span class="keyword">AS</span> <span class="keyword">Day</span>,</span><br><span class="line">       <span class="keyword">ROUND</span>(<span class="keyword">SUM</span>((<span class="keyword">CASE</span> <span class="keyword">WHEN</span> <span class="keyword">Status</span> != <span class="string">'completed'</span> <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)) * <span class="number">1.0</span></span><br><span class="line">             / <span class="keyword">COUNT</span>(*),<span class="number">2</span>) <span class="keyword">AS</span> <span class="string">'Cancellation Rate'</span></span><br><span class="line"> <span class="keyword">FROM</span> Trips</span><br><span class="line"><span class="keyword">WHERE</span> Request_at <span class="keyword">BETWEEN</span> <span class="string">'2013-10-01'</span> <span class="keyword">AND</span> <span class="string">'2013-10-03'</span></span><br><span class="line">      <span class="keyword">AND</span> Client_Id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> Users_Id <span class="keyword">FROM</span> <span class="keyword">Users</span> <span class="keyword">WHERE</span> Banned=<span class="string">'NO'</span> )</span><br><span class="line">      <span class="keyword">AND</span> Driver_Id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> Users_Id <span class="keyword">FROM</span> <span class="keyword">Users</span> <span class="keyword">WHERE</span> Banned=<span class="string">'NO'</span> )</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Request_at;</span><br></pre></td></tr></table></figure>

<h1 id="511-Game-Play-Analysis-I"><a href="#511-Game-Play-Analysis-I" class="headerlink" title="511. Game Play Analysis I"></a>511. Game Play Analysis I</h1><p>Table: Activity</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">+--------------+---------+</span><br><span class="line">|<span class="string"> Column Name  </span>|<span class="string"> Type    </span>|</span><br><span class="line">+--------------+---------+</span><br><span class="line">|<span class="string"> player_id    </span>|<span class="string"> int     </span>|</span><br><span class="line">|<span class="string"> device_id    </span>|<span class="string"> int     </span>|</span><br><span class="line">|<span class="string"> event_date   </span>|<span class="string"> date    </span>|</span><br><span class="line">|<span class="string"> games_played </span>|<span class="string"> int     </span>|</span><br><span class="line">+--------------+---------+</span><br><span class="line">(player_id, event_date) is the primary key of this table.</span><br><span class="line">This table shows the activity of players of some game.</span><br><span class="line">Each row is a record of a player who logged in and played a</span><br><span class="line">number of games (possibly 0) before logging out on some day using some device.</span><br><span class="line"></span><br><span class="line">Activity table:</span><br><span class="line">+-----------+-----------+------------+--------------+</span><br><span class="line">|<span class="string"> player_id </span>|<span class="string"> device_id </span>|<span class="string"> event_date </span>|<span class="string"> games_played </span>|</span><br><span class="line">+-----------+-----------+------------+--------------+</span><br><span class="line">|<span class="string"> 1         </span>|<span class="string"> 2         </span>|<span class="string"> 2016-03-01 </span>|<span class="string"> 5            </span>|</span><br><span class="line">|<span class="string"> 1         </span>|<span class="string"> 2         </span>|<span class="string"> 2016-05-02 </span>|<span class="string"> 6            </span>|</span><br><span class="line">|<span class="string"> 2         </span>|<span class="string"> 3         </span>|<span class="string"> 2017-06-25 </span>|<span class="string"> 1            </span>|</span><br><span class="line">|<span class="string"> 3         </span>|<span class="string"> 1         </span>|<span class="string"> 2016-03-02 </span>|<span class="string"> 0            </span>|</span><br><span class="line">|<span class="string"> 3         </span>|<span class="string"> 4         </span>|<span class="string"> 2018-07-03 </span>|<span class="string"> 5            </span>|</span><br><span class="line">+-----------+-----------+------------+--------------+</span><br></pre></td></tr></table></figure>

<div class="note info">
            <p>Write an SQL query that reports the <strong>first login date</strong> for each player.</p>
          </div>

<p>The query result format is in the following example:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Result table:</span><br><span class="line"><span class="code">+-----------+</span>-------------+</span><br><span class="line">| player<span class="emphasis">_id | first_</span>login |</span><br><span class="line"><span class="code">+-----------+</span>-------------+</span><br><span class="line">| 1         | 2016-03-01  |</span><br><span class="line">| 2         | 2017-06-25  |</span><br><span class="line">| 3         | 2016-03-02  |</span><br><span class="line"><span class="code">+-----------+</span>-------------+</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> player_id, <span class="keyword">MIN</span>(event_date) <span class="keyword">AS</span> first_login</span><br><span class="line">  <span class="keyword">FROM</span> Activity</span><br><span class="line"> <span class="keyword">GROUP</span> <span class="keyword">BY</span> player_id;</span><br></pre></td></tr></table></figure>

<h1 id="512-Game-Play-Analysis-II"><a href="#512-Game-Play-Analysis-II" class="headerlink" title="512. Game Play Analysis II"></a>512. Game Play Analysis II</h1><div class="note info">
            <p>Write a SQL query that reports the <strong>device</strong> that is first logged in for each player.</p>
          </div>

<p>The query result format is in the following example:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Result table:</span><br><span class="line"><span class="code">+-----------+</span>-----------+</span><br><span class="line">| player<span class="emphasis">_id | device_</span>id |</span><br><span class="line"><span class="code">+-----------+</span>-----------+</span><br><span class="line">| 1         | 2         |</span><br><span class="line">| 2         | 3         |</span><br><span class="line">| 3         | 1         |</span><br><span class="line"><span class="code">+-----------+</span>-----------+</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> player_id, device_id</span><br><span class="line">  <span class="keyword">FROM</span> Activity</span><br><span class="line"> <span class="keyword">WHERE</span> (player_id, event_date) <span class="keyword">IN</span></span><br><span class="line">       (<span class="keyword">SELECT</span> player_id, <span class="keyword">MIN</span>(event_date)</span><br><span class="line">          <span class="keyword">FROM</span> Activity</span><br><span class="line">         <span class="keyword">GROUP</span> <span class="keyword">BY</span> player_id)</span><br></pre></td></tr></table></figure>

<h1 id="534-Game-Play-Analysis-III"><a href="#534-Game-Play-Analysis-III" class="headerlink" title="534. Game Play Analysis III"></a>534. Game Play Analysis III</h1><div class="note info">
            <p>Write an SQL query that reports for each player and date, how many games played so far by the player. That is, the total number of games played by the player until that date. Check the example for clarity.</p>
          </div>

<p>The query result format is in the following example:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Result table:</span><br><span class="line"><span class="code">+-----------+</span>------------<span class="code">+---------------------+</span></span><br><span class="line">| player<span class="emphasis">_id | event_</span>date | games<span class="emphasis">_played_</span>so<span class="emphasis">_far |</span></span><br><span class="line"><span class="emphasis">+-----------+------------+---------------------+</span></span><br><span class="line"><span class="emphasis">| 1         | 2016-03-01 | 5                   |</span></span><br><span class="line"><span class="emphasis">| 1         | 2016-05-02 | 11                  |</span></span><br><span class="line"><span class="emphasis">| 1         | 2017-06-25 | 12                  |</span></span><br><span class="line"><span class="emphasis">| 3         | 2016-03-02 | 0                   |</span></span><br><span class="line"><span class="emphasis">| 3         | 2018-07-03 | 5                   |</span></span><br><span class="line"><span class="emphasis">+-----------+------------+---------------------+</span></span><br><span class="line"><span class="emphasis">For the player with id 1, 5 + 6 = 11 games played by 2016-05-02,</span></span><br><span class="line"><span class="emphasis">and 5 + 6 + 1 = 12 games played by 2017-06-25.</span></span><br><span class="line"><span class="emphasis">For the player with id 3, 0 + 5 = 5 games played by 2018-07-03.</span></span><br><span class="line"><span class="emphasis">Note that for each player we only care about the days when the player logged in.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> player_id,</span><br><span class="line">       event_date,</span><br><span class="line">       <span class="keyword">SUM</span>(games_played) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> player_id <span class="keyword">ORDER</span> <span class="keyword">BY</span> event_date)</span><br><span class="line">          <span class="keyword">AS</span> games_played_so_far</span><br><span class="line">  <span class="keyword">FROM</span> Activity</span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> player_id;</span><br></pre></td></tr></table></figure>

<h1 id="550-Game-Play-Analysis-IV"><a href="#550-Game-Play-Analysis-IV" class="headerlink" title="550. Game Play Analysis IV"></a>550. Game Play Analysis IV</h1><div class="note info">
            <p>Write an SQL query that reports the fraction of players that logged in again on the day after the day they first logged in, rounded to 2 decimal places. In other words, you need to count the number of players that logged in for at least two consecutive days starting from their first login date, then divide that number by the total number of players.</p>
          </div>

<p>The query result format is in the following example:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Result table:</span><br><span class="line"><span class="code">+-----------+</span></span><br><span class="line">| fraction  |</span><br><span class="line"><span class="code">+-----------+</span></span><br><span class="line">| 0.33      |</span><br><span class="line"><span class="code">+-----------+</span></span><br><span class="line">Only the player with id 1 logged back in after the first day he had logged</span><br><span class="line">in so the answer is 1/3 = 0.33</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">ROUND</span>(</span><br><span class="line">       <span class="keyword">COUNT</span>(a.event_date)*<span class="number">1.0</span>/ <span class="keyword">COUNT</span>(temp.player_id),<span class="number">2</span>) <span class="keyword">AS</span> fraction</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">      (<span class="keyword">SELECT</span> player_id, <span class="keyword">MIN</span>(event_date) <span class="keyword">AS</span> first_login</span><br><span class="line">         <span class="keyword">FROM</span> Activity</span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span> player_id) temp</span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Activity a</span><br><span class="line">    <span class="keyword">ON</span> temp.player_id = a.player_id <span class="keyword">AND</span> temp.first_login = a.event_date - <span class="string">'INTERVAL 1 day'</span></span><br></pre></td></tr></table></figure>

<h1 id="1097-Game-Play-Analysis-V"><a href="#1097-Game-Play-Analysis-V" class="headerlink" title="1097. Game Play Analysis V"></a>1097. Game Play Analysis V</h1><p>We define the <em>install</em> date of a player to be the first login day of that player.</p>
<p>We also define <em>day 1 retention</em> of some date <code>X</code> to be the number of players whose install date is <code>X</code> and they logged back in on the day right after <code>X</code>, divided by the number of players whose install date is <code>X</code>, <strong>rounded to 2 decimal places</strong>.</p>
<div class="note info">
            <p>Write an SQL query that reports for each <strong>install date</strong>, the <strong>number of players</strong> that installed the game on that day and the <strong>day 1 retention</strong>.</p>
          </div>

<p>The query result format is in the following example:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Result table:</span><br><span class="line"><span class="code">+------------+</span>----------<span class="code">+----------------+</span></span><br><span class="line">| install<span class="emphasis">_dt | installs | Day1_</span>retention |</span><br><span class="line"><span class="code">+------------+</span>----------<span class="code">+----------------+</span></span><br><span class="line">| 2016-03-01 | 2        | 0.50           |</span><br><span class="line">| 2017-06-25 | 1        | 0.00           |</span><br><span class="line"><span class="code">+------------+</span>----------<span class="code">+----------------+</span></span><br><span class="line">Player 1 and 3 installed the game on 2016-03-01 but only player 1 logged back</span><br><span class="line">in on 2016-03-02 so the day 1 retention of 2016-03-01 is 1 / 2 = 0.50</span><br><span class="line">Player 2 installed the game on 2017-06-25 but didn't log back in on 2017-06-26</span><br><span class="line">so the day 1 retention of 2017-06-25 is 0 / 1 = 0.00</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> install_dt, <span class="keyword">COUNT</span>(temp.player_id) <span class="keyword">AS</span> installs,</span><br><span class="line">       <span class="keyword">ROUND</span>(<span class="keyword">COUNT</span>(a.event_date)*<span class="number">1.0</span>/ <span class="keyword">COUNT</span>(*),<span class="number">2</span>) <span class="keyword">AS</span> Day1_retention</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">      (<span class="keyword">SELECT</span> player_id, <span class="keyword">MIN</span>(event_date) <span class="keyword">AS</span> install_dt</span><br><span class="line">         <span class="keyword">FROM</span> Activity</span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span> player_id) temp</span><br><span class="line">  <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Activity a</span><br><span class="line">    <span class="keyword">ON</span> temp.player_id = a.player_id <span class="keyword">AND</span> temp.install_dt = a.event_date - <span class="number">1</span></span><br><span class="line">  <span class="keyword">GROUP</span> <span class="keyword">BY</span> install_dt;</span><br></pre></td></tr></table></figure>

<h1 id="569-Median-Employee-Salary"><a href="#569-Median-Employee-Salary" class="headerlink" title="569. Median Employee Salary"></a>569. Median Employee Salary</h1><p>The <code>Employee</code> table holds all employees. The employee table has three columns: Employee Id, Company Name, and Salary.</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">+-----+------------+--------+</span><br><span class="line">|<span class="string">Id   </span>|<span class="string"> Company    </span>|<span class="string"> Salary </span>|</span><br><span class="line">+-----+------------+--------+</span><br><span class="line">|<span class="string">1    </span>|<span class="string"> A          </span>|<span class="string"> 2341   </span>|</span><br><span class="line">|<span class="string">2    </span>|<span class="string"> A          </span>|<span class="string"> 341    </span>|</span><br><span class="line">|<span class="string">3    </span>|<span class="string"> A          </span>|<span class="string"> 15     </span>|</span><br><span class="line">|<span class="string">4    </span>|<span class="string"> A          </span>|<span class="string"> 15314  </span>|</span><br><span class="line">|<span class="string">5    </span>|<span class="string"> A          </span>|<span class="string"> 451    </span>|</span><br><span class="line">|<span class="string">6    </span>|<span class="string"> A          </span>|<span class="string"> 513    </span>|</span><br><span class="line">|<span class="string">7    </span>|<span class="string"> B          </span>|<span class="string"> 15     </span>|</span><br><span class="line">|<span class="string">8    </span>|<span class="string"> B          </span>|<span class="string"> 13     </span>|</span><br><span class="line">|<span class="string">9    </span>|<span class="string"> B          </span>|<span class="string"> 1154   </span>|</span><br><span class="line">|<span class="string">10   </span>|<span class="string"> B          </span>|<span class="string"> 1345   </span>|</span><br><span class="line">|<span class="string">11   </span>|<span class="string"> B          </span>|<span class="string"> 1221   </span>|</span><br><span class="line">|<span class="string">12   </span>|<span class="string"> B          </span>|<span class="string"> 234    </span>|</span><br><span class="line">|<span class="string">13   </span>|<span class="string"> C          </span>|<span class="string"> 2345   </span>|</span><br><span class="line">|<span class="string">14   </span>|<span class="string"> C          </span>|<span class="string"> 2645   </span>|</span><br><span class="line">|<span class="string">15   </span>|<span class="string"> C          </span>|<span class="string"> 2645   </span>|</span><br><span class="line">|<span class="string">16   </span>|<span class="string"> C          </span>|<span class="string"> 2652   </span>|</span><br><span class="line">|<span class="string">17   </span>|<span class="string"> C          </span>|<span class="string"> 65     </span>|</span><br><span class="line">+-----+------------+--------+</span><br></pre></td></tr></table></figure>

<p>Write a SQL query to find the median salary of each company. Bonus points if you can solve it without using any built-in SQL functions.</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+-----+------------+--------+</span><br><span class="line">|<span class="string">Id   </span>|<span class="string"> Company    </span>|<span class="string"> Salary </span>|</span><br><span class="line">+-----+------------+--------+</span><br><span class="line">|<span class="string">5    </span>|<span class="string"> A          </span>|<span class="string"> 451    </span>|</span><br><span class="line">|<span class="string">6    </span>|<span class="string"> A          </span>|<span class="string"> 513    </span>|</span><br><span class="line">|<span class="string">12   </span>|<span class="string"> B          </span>|<span class="string"> 234    </span>|</span><br><span class="line">|<span class="string">9    </span>|<span class="string"> B          </span>|<span class="string"> 1154   </span>|</span><br><span class="line">|<span class="string">14   </span>|<span class="string"> C          </span>|<span class="string"> 2645   </span>|</span><br><span class="line">+-----+------------+--------+</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">Id</span>, Company, Salary</span><br><span class="line">  <span class="keyword">FROM</span></span><br><span class="line">     (<span class="keyword">SELECT</span> *,</span><br><span class="line">        ROW_NUMBER() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> Company <span class="keyword">ORDER</span> <span class="keyword">BY</span> Salary) <span class="keyword">AS</span> rank_number,</span><br><span class="line">             <span class="keyword">COUNT</span>(<span class="keyword">Id</span>) <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> Company)  <span class="keyword">AS</span> total</span><br><span class="line">        <span class="keyword">FROM</span> Employee) <span class="keyword">AS</span> temp</span><br><span class="line"> <span class="keyword">WHERE</span> (total % <span class="number">2</span> &lt;&gt; <span class="number">0</span>  <span class="keyword">AND</span> rank_number = total/<span class="number">2</span> + <span class="number">1</span>) <span class="keyword">OR</span></span><br><span class="line">       (total % <span class="number">2</span> = <span class="number">0</span>   <span class="keyword">AND</span> (rank_number =total/<span class="number">2</span>  <span class="keyword">or</span> rank_number = total/<span class="number">2</span> + <span class="number">1</span> ))</span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> Company, Salary</span><br></pre></td></tr></table></figure>

<h1 id="570-Managers-with-at-Least-5-Direct-Reports"><a href="#570-Managers-with-at-Least-5-Direct-Reports" class="headerlink" title="570. Managers with at Least 5 Direct Reports"></a>570. Managers with at Least 5 Direct Reports</h1><p>The <code>Employee</code> table holds all employees including their managers. Every employee has an Id, and there is also a column for the manager Id.</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+------+----------+-----------+----------+</span><br><span class="line">|<span class="string">Id    </span>|<span class="string">Name 	  </span>|<span class="string">Department </span>|<span class="string">ManagerId </span>|</span><br><span class="line">+------+----------+-----------+----------+</span><br><span class="line">|<span class="string">101   </span>|<span class="string">John 	  </span>|<span class="string">A 	      </span>|<span class="string">null      </span>|</span><br><span class="line">|<span class="string">102   </span>|<span class="string">Dan 	  </span>|<span class="string">A 	      </span>|<span class="string">101       </span>|</span><br><span class="line">|<span class="string">103   </span>|<span class="string">James 	  </span>|<span class="string">A 	      </span>|<span class="string">101       </span>|</span><br><span class="line">|<span class="string">104   </span>|<span class="string">Amy 	  </span>|<span class="string">A 	      </span>|<span class="string">101       </span>|</span><br><span class="line">|<span class="string">105   </span>|<span class="string">Anne 	  </span>|<span class="string">A 	      </span>|<span class="string">101       </span>|</span><br><span class="line">|<span class="string">106   </span>|<span class="string">Ron 	  </span>|<span class="string">B 	      </span>|<span class="string">101       </span>|</span><br><span class="line">+------+----------+-----------+----------+</span><br></pre></td></tr></table></figure>

<p>Given the <code>Employee</code> table, write a SQL query that finds out managers with at least 5 direct report. For the above table, your SQL query should return:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+-------+</span></span><br><span class="line">| Name  |</span><br><span class="line"><span class="code">+-------+</span></span><br><span class="line">| John  |</span><br><span class="line"><span class="code">+-------+</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">Name</span></span><br><span class="line">  <span class="keyword">FROM</span> Employee</span><br><span class="line"> <span class="keyword">WHERE</span> <span class="keyword">Id</span> <span class="keyword">IN</span></span><br><span class="line">      (<span class="keyword">SELECT</span> ManagerId</span><br><span class="line">         <span class="keyword">FROM</span> Employee</span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span> ManagerId</span><br><span class="line">       <span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(ManagerId) &gt;= <span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<h1 id="571-Find-Median-Given-Frequency-of-Numbers"><a href="#571-Find-Median-Given-Frequency-of-Numbers" class="headerlink" title="571. Find Median Given Frequency of Numbers"></a>571. Find Median Given Frequency of Numbers</h1><p>The <code>Numbers</code> table keeps the value of number and its frequency.</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+----------+-------------+</span><br><span class="line">|<span class="string">  Number  </span>|<span class="string">  Frequency  </span>|</span><br><span class="line">+----------+-------------|</span><br><span class="line">|<span class="string">  0       </span>|<span class="string">  7          </span>|</span><br><span class="line">|<span class="string">  1       </span>|<span class="string">  1          </span>|</span><br><span class="line">|<span class="string">  2       </span>|<span class="string">  3          </span>|</span><br><span class="line">|<span class="string">  3       </span>|<span class="string">  1          </span>|</span><br><span class="line">+----------+-------------+</span><br></pre></td></tr></table></figure>

<p>In this table, the numbers are <code>0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 2, 3</code>, so the median is (0 + 0) / 2 = 0.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+--------+</span></span><br><span class="line">| median |</span><br><span class="line">+--------|</span><br><span class="line">| 0.0000 |</span><br><span class="line"><span class="code">+--------+</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="574-Winning-Candidate"><a href="#574-Winning-Candidate" class="headerlink" title="574. Winning Candidate"></a>574. Winning Candidate</h1><p>Table: <code>Candidate</code></p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+-----+</span>---------+</span><br><span class="line">| id  | Name    |</span><br><span class="line"><span class="code">+-----+</span>---------+</span><br><span class="line">| 1   | A       |</span><br><span class="line">| 2   | B       |</span><br><span class="line">| 3   | C       |</span><br><span class="line">| 4   | D       |</span><br><span class="line">| 5   | E       |</span><br><span class="line"><span class="code">+-----+</span>---------+</span><br></pre></td></tr></table></figure>

<p>Table: <code>Vote</code></p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+-----+</span>--------------+</span><br><span class="line">| id  | CandidateId  |</span><br><span class="line"><span class="code">+-----+</span>--------------+</span><br><span class="line">| 1   |     2        |</span><br><span class="line">| 2   |     4        |</span><br><span class="line">| 3   |     3        |</span><br><span class="line">| 4   |     2        |</span><br><span class="line">| 5   |     5        |</span><br><span class="line"><span class="code">+-----+</span>--------------+</span><br><span class="line">id is the auto-increment primary key,</span><br><span class="line">CandidateId is the id appeared in Candidate table.</span><br></pre></td></tr></table></figure>

<p>Write a sql to find the name of the winning candidate, the above example will return the winner <code>B</code>.</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+------+</span></span><br><span class="line">| Name |</span><br><span class="line"><span class="code">+------+</span></span><br><span class="line">| B    |</span><br><span class="line"><span class="code">+------+</span></span><br></pre></td></tr></table></figure>

<p>Notes:</p>
<p>You may assume there is no tie, in other words there will be at most one winning candidate.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*MySQL*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">Name</span></span><br><span class="line"><span class="keyword">FROM</span> Candidate</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">id</span> =  (<span class="keyword">SELECT</span> CandidateId</span><br><span class="line">                  <span class="keyword">FROM</span> Vote</span><br><span class="line">                  <span class="keyword">GROUP</span> <span class="keyword">BY</span> CandidateId</span><br><span class="line">                  <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">COUNT</span>(CandidateId) <span class="keyword">DESC</span></span><br><span class="line">                  <span class="keyword">LIMIT</span> <span class="number">1</span>);</span><br><span class="line"><span class="comment">/* MS SQL Server */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">Name</span></span><br><span class="line"><span class="keyword">FROM</span> Candidate</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">id</span> = (<span class="keyword">SELECT</span> TOP <span class="number">1</span> CandidateId</span><br><span class="line">            <span class="keyword">FROM</span> Vote</span><br><span class="line">            <span class="keyword">GROUP</span> <span class="keyword">BY</span> CandidateId</span><br><span class="line">            <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">COUNT</span>(CandidateId) <span class="keyword">DESC</span>);</span><br></pre></td></tr></table></figure>

<h1 id="577-Employee-Bonus"><a href="#577-Employee-Bonus" class="headerlink" title="577. Employee Bonus"></a>577. Employee Bonus</h1><p>Select all employee’s name and bonus whose bonus is &lt; 1000.</p>
<p>Table: <code>Employee</code></p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+-------+--------+-----------+--------+</span><br><span class="line">|<span class="string"> empId </span>|<span class="string">  name  </span>|<span class="string"> supervisor</span>|<span class="string"> salary </span>|</span><br><span class="line">+-------+--------+-----------+--------+</span><br><span class="line">|<span class="string">   1   </span>|<span class="string"> John   </span>|<span class="string">  3        </span>|<span class="string"> 1000   </span>|</span><br><span class="line">|<span class="string">   2   </span>|<span class="string"> Dan    </span>|<span class="string">  3        </span>|<span class="string"> 2000   </span>|</span><br><span class="line">|<span class="string">   3   </span>|<span class="string"> Brad   </span>|<span class="string">  null     </span>|<span class="string"> 4000   </span>|</span><br><span class="line">|<span class="string">   4   </span>|<span class="string"> Thomas </span>|<span class="string">  3        </span>|<span class="string"> 4000   </span>|</span><br><span class="line">+-------+--------+-----------+--------+</span><br><span class="line">empId is the primary key column for this table.</span><br></pre></td></tr></table></figure>

<p>Table: <code>Bonus</code></p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+-------+</span>-------+</span><br><span class="line">| empId | bonus |</span><br><span class="line"><span class="code">+-------+</span>-------+</span><br><span class="line">| 2     | 500   |</span><br><span class="line">| 4     | 2000  |</span><br><span class="line"><span class="code">+-------+</span>-------+</span><br><span class="line">empId is the primary key column for this table.</span><br></pre></td></tr></table></figure>

<p>Example ouput:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+-------+</span>-------+</span><br><span class="line">| name  | bonus |</span><br><span class="line"><span class="code">+-------+</span>-------+</span><br><span class="line">| John  | null  |</span><br><span class="line">| Dan   | 500   |</span><br><span class="line">| Brad  | null  |</span><br><span class="line"><span class="code">+-------+</span>-------+</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*MySQL*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span>, bonus</span><br><span class="line"><span class="keyword">FROM</span> Employee e</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Bonus b</span><br><span class="line"><span class="keyword">ON</span> e.empId = b.empId</span><br><span class="line"><span class="keyword">WHERE</span> bonus &lt; <span class="number">1000</span> <span class="keyword">or</span> bonus <span class="keyword">IS</span> <span class="literal">NULL</span></span><br><span class="line">;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* MS SQL Server */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span>, bonus</span><br><span class="line"><span class="keyword">FROM</span> Employee</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> Bonus</span><br><span class="line"><span class="keyword">ON</span> Employee.empId = Bonus.empId</span><br><span class="line"><span class="keyword">WHERE</span> bonus &lt; <span class="number">1000</span> <span class="keyword">OR</span> bonus <span class="keyword">IS</span> <span class="literal">NULL</span></span><br></pre></td></tr></table></figure>

<h1 id="578-Get-Highest-Answer-Rate-Question"><a href="#578-Get-Highest-Answer-Rate-Question" class="headerlink" title="578. Get Highest Answer Rate Question"></a>578. Get Highest Answer Rate Question</h1><p>Get the highest answer rate question from a table survey_log with these columns: uid, action, question_id, answer_id, q_num, timestamp.</p>
<p>uid means user id; action has these kind of values: “show”, “answer”, “skip”; answer_id is not null when action column is “answer”, while is null for “show” and “skip”; q_num is the numeral order of the question in current session.</p>
<p>Write a sql query to identify the question which has the highest answer rate.</p>
<p>Example:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Input:</span><br><span class="line"><span class="code">+------+</span>-----------<span class="code">+--------------+</span>------------<span class="code">+-----------+</span>------------+</span><br><span class="line">| uid  | action    | question<span class="emphasis">_id  | answer_</span>id  | q<span class="emphasis">_num     | timestamp  |</span></span><br><span class="line"><span class="emphasis">+------+-----------+--------------+------------+-----------+------------+</span></span><br><span class="line"><span class="emphasis">| 5    | show      | 285          | null       | 1         | 123        |</span></span><br><span class="line"><span class="emphasis">| 5    | answer    | 285          | 124124     | 1         | 124        |</span></span><br><span class="line"><span class="emphasis">| 5    | show      | 369          | null       | 2         | 125        |</span></span><br><span class="line"><span class="emphasis">| 5    | skip      | 369          | null       | 2         | 126        |</span></span><br><span class="line"><span class="emphasis">+------+-----------+--------------+------------+-----------+------------+</span></span><br><span class="line"><span class="emphasis">Output:</span></span><br><span class="line"><span class="emphasis">+-------------+</span></span><br><span class="line"><span class="emphasis">| survey_</span>log  |</span><br><span class="line"><span class="code">+-------------+</span></span><br><span class="line">|    285      |</span><br><span class="line"><span class="code">+-------------+</span></span><br><span class="line">Explanation:</span><br><span class="line">question 285 has answer rate 1/1, while question 369 has 0/1 answer rate, so output 285.</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* MySQL */</span></span><br><span class="line"><span class="keyword">SELECT</span> question_id <span class="keyword">AS</span> survey_log</span><br><span class="line"><span class="keyword">FROM</span> survey_log</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> question_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> <span class="keyword">action</span> = <span class="string">'answer'</span> <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>)/</span><br><span class="line">         <span class="keyword">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> <span class="keyword">action</span> = <span class="string">'show'</span> <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) <span class="keyword">DESC</span></span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* MS SQL server</span></span><br><span class="line"><span class="comment">   Error 22012: Divide by zero error encountered (8134)</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h1 id="579-Find-Cumulative-Salary-of-an-Employee"><a href="#579-Find-Cumulative-Salary-of-an-Employee" class="headerlink" title="579. Find Cumulative Salary of an Employee"></a>579. Find Cumulative Salary of an Employee</h1><p>The <code>Employee</code> table holds the salary information in a year.</p>
<p>Write a SQL to get the cumulative sum of an employee’s salary over a period of 3 months but exclude the most recent month.</p>
<p>The result should be displayed by ‘Id’ ascending, and then by ‘Month’ descending.</p>
<ul>
<li>计算员工的累计薪水</li>
<li>编写一个SQL来获取员工在3个月内的工资累计总和，但不包括最近一个月。</li>
</ul>
<p>Example<br>Input</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> Id </span>|<span class="string"> Month </span>|<span class="string"> Salary </span>|</span><br><span class="line">|<span class="string">----</span>|<span class="string">-------</span>|<span class="string">--------</span>|</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> 1     </span>|<span class="string"> 20     </span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string"> 1     </span>|<span class="string"> 20     </span>|</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> 2     </span>|<span class="string"> 30     </span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string"> 2     </span>|<span class="string"> 30     </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> 2     </span>|<span class="string"> 40     </span>|</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> 3     </span>|<span class="string"> 40     </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> 3     </span>|<span class="string"> 60     </span>|</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> 4     </span>|<span class="string"> 60     </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> 4     </span>|<span class="string"> 70     </span>|</span><br></pre></td></tr></table></figure>

<p>Output</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> Id </span>|<span class="string"> Month </span>|<span class="string"> Salary </span>|</span><br><span class="line">|<span class="string">----</span>|<span class="string">-------</span>|<span class="string">--------</span>|</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> 3     </span>|<span class="string"> 90     </span>|</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> 2     </span>|<span class="string"> 50     </span>|</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> 1     </span>|<span class="string"> 20     </span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string"> 1     </span>|<span class="string"> 20     </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> 3     </span>|<span class="string"> 100    </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> 2     </span>|<span class="string"> 40     </span>|</span><br></pre></td></tr></table></figure>

<p><strong>Explanation</strong></p>
<p>员工’1’在接下来的3个月中有3个工资记录，最近一个月’4’除外：第3个月的工资为40，第2个月为30个月，第1个月为20个月 因此，该员工3个月以上的累计工资额分别为90（40 + 30 + 20），50（30 + 20）和20。</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> Id </span>|<span class="string"> Month </span>|<span class="string"> Salary </span>|</span><br><span class="line">|<span class="string">----</span>|<span class="string">-------</span>|<span class="string">--------</span>|</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> 3     </span>|<span class="string"> 90     </span>|</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> 2     </span>|<span class="string"> 50     </span>|</span><br><span class="line">|<span class="string"> 1  </span>|<span class="string"> 1     </span>|<span class="string"> 20     </span>|</span><br></pre></td></tr></table></figure>

<p>员工’2’只有一个工资记录（月’1’），除了最近一个月’2’。</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> Id </span>|<span class="string"> Month </span>|<span class="string"> Salary </span>|</span><br><span class="line">|<span class="string">----</span>|<span class="string">-------</span>|<span class="string">--------</span>|</span><br><span class="line">|<span class="string"> 2  </span>|<span class="string"> 1     </span>|<span class="string"> 20     </span>|</span><br></pre></td></tr></table></figure>

<p>雇员’3’有两个工资记录，除了最近的工资月’4’：月’3’与60和月’2’与40。所以累计工资如下。</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> Id </span>|<span class="string"> Month </span>|<span class="string"> Salary </span>|</span><br><span class="line">|<span class="string">----</span>|<span class="string">-------</span>|<span class="string">--------</span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> 3     </span>|<span class="string"> 100    </span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> 2     </span>|<span class="string"> 40     </span>|</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* MS SQL Server*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">id</span>, <span class="keyword">month</span>, Salary</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    (<span class="keyword">SELECT</span> <span class="keyword">id</span>,</span><br><span class="line">            <span class="keyword">month</span>,</span><br><span class="line">            <span class="keyword">SUM</span>(salary) <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">id</span>  <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">month</span> <span class="keyword">ROWS</span> <span class="number">2</span> <span class="keyword">PRECEDING</span>) <span class="keyword">AS</span> Salary,</span><br><span class="line">            ROW_NUMBER() <span class="keyword">OVER</span>(<span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">id</span> <span class="keyword">ORDER</span> <span class="keyword">by</span> <span class="keyword">month</span> <span class="keyword">DESC</span>) month_no</span><br><span class="line">    <span class="keyword">FROM</span> Employee)  <span class="keyword">AS</span> temp</span><br><span class="line"><span class="keyword">WHERE</span> month_no &gt; <span class="number">1</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">id</span> , <span class="keyword">month</span> <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p>ROW 2 PRECEDING 窗口大小为3， 计算当前月份的前面三个月的累计工资</p>
<h1 id="580-Count-Student-Number-in-Departments"><a href="#580-Count-Student-Number-in-Departments" class="headerlink" title="580. Count Student Number in Departments"></a>580. Count Student Number in Departments</h1><p>A university uses 2 data tables, student and department, to store data about its students and the departments associated with each major.</p>
<p>Write a query to print the respective department name and number of students majoring in each department for all departments in the department table (even ones with no current students).</p>
<p>Sort your results by descending number of students; if two or more departments have the same number of students, then sort those departments alphabetically by department name.</p>
<p>The <code>student</code> is described as follow:</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> Column Name  </span>|<span class="string"> Type      </span>|</span><br><span class="line">|<span class="string">--------------</span>|<span class="string">-----------</span>|</span><br><span class="line">|<span class="string"> student_id   </span>|<span class="string"> Integer   </span>|</span><br><span class="line">|<span class="string"> student_name </span>|<span class="string"> String    </span>|</span><br><span class="line">|<span class="string"> gender       </span>|<span class="string"> Character </span>|</span><br><span class="line">|<span class="string"> dept_id      </span>|<span class="string"> Integer   </span>|</span><br></pre></td></tr></table></figure>

<p>where student_id is the student’s ID number, student_name is the student’s name, gender is their gender, and dept_id is the department ID associated with their declared major.</p>
<p>And the <code>department</code> table is described as below:</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> Column Name </span>|<span class="string"> Type    </span>|</span><br><span class="line">|<span class="string">-------------</span>|<span class="string">---------</span>|</span><br><span class="line">|<span class="string"> dept_id     </span>|<span class="string"> Integer </span>|</span><br><span class="line">|<span class="string"> dept_name   </span>|<span class="string"> String  </span>|</span><br></pre></td></tr></table></figure>

<p>where dept_id is the department’s ID number and dept_name is the department name.</p>
<p>Here is an example input:<br><code>student</code> table:</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> student_id </span>|<span class="string"> student_name </span>|<span class="string"> gender </span>|<span class="string"> dept_id </span>|</span><br><span class="line">|<span class="string">------------</span>|<span class="string">--------------</span>|<span class="string">--------</span>|<span class="string">---------</span>|</span><br><span class="line">|<span class="string"> 1          </span>|<span class="string"> Jack         </span>|<span class="string"> M      </span>|<span class="string"> 1       </span>|</span><br><span class="line">|<span class="string"> 2          </span>|<span class="string"> Jane         </span>|<span class="string"> F      </span>|<span class="string"> 1       </span>|</span><br><span class="line">|<span class="string"> 3          </span>|<span class="string"> Mark         </span>|<span class="string"> M      </span>|<span class="string"> 2       </span>|</span><br></pre></td></tr></table></figure>

<p><code>department</code> table:</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> dept_id </span>|<span class="string"> dept_name   </span>|</span><br><span class="line">|<span class="string">---------</span>|<span class="string">-------------</span>|</span><br><span class="line">|<span class="string"> 1       </span>|<span class="string"> Engineering </span>|</span><br><span class="line">|<span class="string"> 2       </span>|<span class="string"> Science     </span>|</span><br><span class="line">|<span class="string"> 3       </span>|<span class="string"> Law         </span>|</span><br></pre></td></tr></table></figure>

<p>The <code>Output</code> should be:</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> dept_name   </span>|<span class="string"> student_number </span>|</span><br><span class="line">|<span class="string">-------------</span>|<span class="string">----------------</span>|</span><br><span class="line">|<span class="string"> Engineering </span>|<span class="string"> 2              </span>|</span><br><span class="line">|<span class="string"> Science     </span>|<span class="string"> 1              </span>|</span><br><span class="line">|<span class="string"> Law         </span>|<span class="string"> 0              </span>|</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> d.dept_name, <span class="keyword">COUNT</span>(student_id) <span class="keyword">AS</span> student_number</span><br><span class="line"><span class="keyword">FROM</span> department d</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> student s</span><br><span class="line"><span class="keyword">ON</span> d.dept_id = s.dept_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">2</span> <span class="keyword">DESC</span>, <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h1 id="584-Find-Customer-Referee"><a href="#584-Find-Customer-Referee" class="headerlink" title="584. Find Customer Referee"></a>584. Find Customer Referee</h1><p>Given a table <code>customer</code> holding customers information and the referee.</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+------+------+-----------+</span><br><span class="line">|<span class="string"> id   </span>|<span class="string"> name </span>|<span class="string"> referee_id</span>|</span><br><span class="line">+------+------+-----------+</span><br><span class="line">|<span class="string">    1 </span>|<span class="string"> Will </span>|<span class="string">      NULL </span>|</span><br><span class="line">|<span class="string">    2 </span>|<span class="string"> Jane </span>|<span class="string">      NULL </span>|</span><br><span class="line">|<span class="string">    3 </span>|<span class="string"> Alex </span>|<span class="string">         2 </span>|</span><br><span class="line">|<span class="string">    4 </span>|<span class="string"> Bill </span>|<span class="string">      NULL </span>|</span><br><span class="line">|<span class="string">    5 </span>|<span class="string"> Zack </span>|<span class="string">         1 </span>|</span><br><span class="line">|<span class="string">    6 </span>|<span class="string"> Mark </span>|<span class="string">         2 </span>|</span><br><span class="line">+------+------+-----------+</span><br></pre></td></tr></table></figure>

<p>Write a query to return the list of customers <strong>NOT</strong> referred by the person with id ‘2’.</p>
<p>For the sample data above, the result is:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+------+</span></span><br><span class="line">| name |</span><br><span class="line"><span class="code">+------+</span></span><br><span class="line">| Will |</span><br><span class="line">| Jane |</span><br><span class="line">| Bill |</span><br><span class="line">| Zack |</span><br><span class="line"><span class="code">+------+</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span></span><br><span class="line"><span class="keyword">FROM</span> customer</span><br><span class="line"><span class="keyword">WHERE</span> referee_id != <span class="number">2</span> <span class="keyword">or</span> referee_id <span class="keyword">IS</span> <span class="literal">NULL</span></span><br></pre></td></tr></table></figure>

<h1 id="585-Investments-in-2016"><a href="#585-Investments-in-2016" class="headerlink" title="585. Investments in 2016"></a>585. Investments in 2016</h1><p><strong>要求</strong>：<br>求2016年的总投资价值， policyholder 需要满足以下两个条件</p>
<ol>
<li>TIV_2015的投资总价值要喝其他的 policyholder 一样</li>
<li>地里位置不能和其他的 policyholder 一样 (纬度, 经度) 需要唯一</li>
</ol>
<p>The insurance table is described as follows:</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> Column Name </span>|<span class="string"> Type          </span>|</span><br><span class="line">|<span class="string">-------------</span>|<span class="string">---------------</span>|</span><br><span class="line">|<span class="string"> PID         </span>|<span class="string"> INTEGER(11)   </span>|</span><br><span class="line">|<span class="string"> TIV_2015    </span>|<span class="string"> NUMERIC(15,2) </span>|</span><br><span class="line">|<span class="string"> TIV_2016    </span>|<span class="string"> NUMERIC(15,2) </span>|</span><br><span class="line">|<span class="string"> LAT         </span>|<span class="string"> NUMERIC(5,2)  </span>|</span><br><span class="line">|<span class="string"> LON         </span>|<span class="string"> NUMERIC(5,2)  </span>|</span><br></pre></td></tr></table></figure>

<ul>
<li>PID 是policyholder’s 的 ID</li>
<li>TIV_2015 是2015年的总投资价值</li>
<li>TIV_2016 是2016年的总投资价值</li>
<li>LAT 维度</li>
<li>LON 经度</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(TIV_2016) <span class="keyword">AS</span> TIV_2016</span><br><span class="line"><span class="keyword">FROM</span> insurance</span><br><span class="line"><span class="keyword">WHERE</span> TIV_2015</span><br><span class="line">     <span class="keyword">IN</span></span><br><span class="line">       (<span class="keyword">SELECT</span> TIV_2015</span><br><span class="line">           <span class="keyword">FROM</span> insurance</span><br><span class="line">           <span class="keyword">GROUP</span> <span class="keyword">BY</span> TIV_2015</span><br><span class="line">           <span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(TIV_2015) &gt; <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">AND</span> <span class="keyword">CONCAT</span>(LAT,LON)</span><br><span class="line">    <span class="keyword">IN</span></span><br><span class="line">       (<span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(LAT,LON)</span><br><span class="line">           <span class="keyword">FROM</span> insurance</span><br><span class="line">           <span class="keyword">GROUP</span> <span class="keyword">BY</span> LAT , LON</span><br><span class="line">           <span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(*) = <span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h1 id="586-Customer-Placing-the-Largest-Number-of-Orders"><a href="#586-Customer-Placing-the-Largest-Number-of-Orders" class="headerlink" title="586. Customer Placing the Largest Number of Orders"></a>586. Customer Placing the Largest Number of Orders</h1><p>Query the <strong>customer_number</strong> from the <em>orders</em> table for the customer who has placed the largest number of orders.</p>
<p>It is guaranteed that exactly one customer will have placed more orders than any other customer.</p>
<p>The <em>orders</em> table is defined as follows:</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> Column            </span>|<span class="string"> Type      </span>|</span><br><span class="line">|<span class="string">-------------------</span>|<span class="string">-----------</span>|</span><br><span class="line">|<span class="string"> order_number (PK) </span>|<span class="string"> int       </span>|</span><br><span class="line">|<span class="string"> customer_number   </span>|<span class="string"> int       </span>|</span><br><span class="line">|<span class="string"> order_date        </span>|<span class="string"> date      </span>|</span><br><span class="line">|<span class="string"> required_date     </span>|<span class="string"> date      </span>|</span><br><span class="line">|<span class="string"> shipped_date      </span>|<span class="string"> date      </span>|</span><br><span class="line">|<span class="string"> status            </span>|<span class="string"> char(15)  </span>|</span><br><span class="line">|<span class="string"> comment           </span>|<span class="string"> char(200) </span>|</span><br></pre></td></tr></table></figure>

<p>Sample Input</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> order_number </span>|<span class="string"> customer_number </span>|<span class="string"> order_date </span>|<span class="string"> required_date </span>|<span class="string"> shipped_date </span>|<span class="string"> status </span>|<span class="string"> comment </span>|</span><br><span class="line">|<span class="string">--------------</span>|<span class="string">-----------------</span>|<span class="string">------------</span>|<span class="string">---------------</span>|<span class="string">--------------</span>|<span class="string">--------</span>|<span class="string">---------</span>|</span><br><span class="line">|<span class="string"> 1            </span>|<span class="string"> 1               </span>|<span class="string"> 2017-04-09 </span>|<span class="string"> 2017-04-13    </span>|<span class="string"> 2017-04-12   </span>|<span class="string"> Closed </span>|<span class="string">         </span>|</span><br><span class="line">|<span class="string"> 2            </span>|<span class="string"> 2               </span>|<span class="string"> 2017-04-15 </span>|<span class="string"> 2017-04-20    </span>|<span class="string"> 2017-04-18   </span>|<span class="string"> Closed </span>|<span class="string">         </span>|</span><br><span class="line">|<span class="string"> 3            </span>|<span class="string"> 3               </span>|<span class="string"> 2017-04-16 </span>|<span class="string"> 2017-04-25    </span>|<span class="string"> 2017-04-20   </span>|<span class="string"> Closed </span>|<span class="string">         </span>|</span><br><span class="line">|<span class="string"> 4            </span>|<span class="string"> 3               </span>|<span class="string"> 2017-04-18 </span>|<span class="string"> 2017-04-28    </span>|<span class="string"> 2017-04-25   </span>|<span class="string"> Closed </span>|<span class="string">         </span>|</span><br></pre></td></tr></table></figure>

<p>Sample Output</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> customer_number </span>|</span><br><span class="line">|<span class="string">-----------------</span>|</span><br><span class="line">|<span class="string"> 3               </span>|</span><br></pre></td></tr></table></figure>

<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">The customer <span class="keyword">with</span> number <span class="string">'3'</span> <span class="keyword">has</span> two orders, which <span class="keyword">is</span> greater than either customer <span class="string">'1'</span> <span class="keyword">or</span> <span class="string">'2'</span> because <span class="keyword">each</span> <span class="keyword">of</span> them  only <span class="keyword">has</span> one <span class="keyword">order</span>.</span><br><span class="line">So the <span class="keyword">result</span> <span class="keyword">is</span> customer_number <span class="string">'3'</span>.</span><br></pre></td></tr></table></figure>

<p><strong>Follow up</strong>: What if more than one customer have the largest number of orders, can you find all the customer_number in this case?</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> customer_number</span><br><span class="line"><span class="keyword">FROM</span> orders</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> customer_number</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">COUNT</span>(*) <span class="keyword">DESC</span></span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">1</span></span><br><span class="line">;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* FOLLOW UP*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> customer_number</span><br><span class="line"><span class="keyword">FROM</span> orders</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> customer_number</span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(order_number) = (</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(order_number) cnt</span><br><span class="line">	<span class="keyword">FROM</span> orders</span><br><span class="line">	<span class="keyword">GROUP</span> <span class="keyword">BY</span> customer_number</span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> cnt <span class="keyword">DESC</span></span><br><span class="line">	<span class="keyword">LIMIT</span> <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h1 id="595-Big-Countries"><a href="#595-Big-Countries" class="headerlink" title="595. Big Countries"></a>595. Big Countries</h1><p>There is a table <code>World</code></p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+-----------------+------------+------------+--------------+---------------+</span><br><span class="line">|<span class="string"> name            </span>|<span class="string"> continent  </span>|<span class="string"> area       </span>|<span class="string"> population   </span>|<span class="string"> gdp           </span>|</span><br><span class="line">+-----------------+------------+------------+--------------+---------------+</span><br><span class="line">|<span class="string"> Afghanistan     </span>|<span class="string"> Asia       </span>|<span class="string"> 652230     </span>|<span class="string"> 25500100     </span>|<span class="string"> 20343000      </span>|</span><br><span class="line">|<span class="string"> Albania         </span>|<span class="string"> Europe     </span>|<span class="string"> 28748      </span>|<span class="string"> 2831741      </span>|<span class="string"> 12960000      </span>|</span><br><span class="line">|<span class="string"> Algeria         </span>|<span class="string"> Africa     </span>|<span class="string"> 2381741    </span>|<span class="string"> 37100000     </span>|<span class="string"> 188681000     </span>|</span><br><span class="line">|<span class="string"> Andorra         </span>|<span class="string"> Europe     </span>|<span class="string"> 468        </span>|<span class="string"> 78115        </span>|<span class="string"> 3712000       </span>|</span><br><span class="line">|<span class="string"> Angola          </span>|<span class="string"> Africa     </span>|<span class="string"> 1246700    </span>|<span class="string"> 20609294     </span>|<span class="string"> 100990000     </span>|</span><br><span class="line">+-----------------+------------+------------+--------------+---------------+</span><br></pre></td></tr></table></figure>

<p>A country is big if it has an area of bigger than 3 million square km or a population of more than 25 million.</p>
<p>Write a SQL solution to output big countries’ name, population and area.</p>
<p>For example, according to the above table, we should output:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+--------------+</span>-------------<span class="code">+--------------+</span></span><br><span class="line">| name         | population  | area         |</span><br><span class="line"><span class="code">+--------------+</span>-------------<span class="code">+--------------+</span></span><br><span class="line">| Afghanistan  | 25500100    | 652230       |</span><br><span class="line">| Algeria      | 37100000    | 2381741      |</span><br><span class="line"><span class="code">+--------------+</span>-------------<span class="code">+--------------+</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span>, population, area</span><br><span class="line"><span class="keyword">FROM</span> World</span><br><span class="line"><span class="keyword">WHERE</span> population &gt; <span class="number">25000000</span> <span class="keyword">or</span> area &gt; <span class="number">3000000</span></span><br></pre></td></tr></table></figure>

<h1 id="596-Classes-More-Than-5-Students"><a href="#596-Classes-More-Than-5-Students" class="headerlink" title="596. Classes More Than 5 Students"></a>596. Classes More Than 5 Students</h1><p>There is a table <code>courses</code> with columns: <strong>student</strong> and <strong>class</strong><br>Please list out all classes which have more than or equal to 5 students.<br>For example, the table:</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">+---------+------------+</span><br><span class="line">|<span class="string"> student </span>|<span class="string"> class      </span>|</span><br><span class="line">+---------+------------+</span><br><span class="line">|<span class="string"> A       </span>|<span class="string"> Math       </span>|</span><br><span class="line">|<span class="string"> B       </span>|<span class="string"> English    </span>|</span><br><span class="line">|<span class="string"> C       </span>|<span class="string"> Math       </span>|</span><br><span class="line">|<span class="string"> D       </span>|<span class="string"> Biology    </span>|</span><br><span class="line">|<span class="string"> E       </span>|<span class="string"> Math       </span>|</span><br><span class="line">|<span class="string"> F       </span>|<span class="string"> Computer   </span>|</span><br><span class="line">|<span class="string"> G       </span>|<span class="string"> Math       </span>|</span><br><span class="line">|<span class="string"> H       </span>|<span class="string"> Math       </span>|</span><br><span class="line">|<span class="string"> I       </span>|<span class="string"> Math       </span>|</span><br><span class="line">+---------+------------+</span><br></pre></td></tr></table></figure>

<p>Should output:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+---------+</span></span><br><span class="line">| class   |</span><br><span class="line"><span class="code">+---------+</span></span><br><span class="line">| Math    |</span><br><span class="line"><span class="code">+---------+</span></span><br></pre></td></tr></table></figure>

<p><strong>Note</strong>:<br>The students should not be counted duplicate in each course.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">class</span></span><br><span class="line"><span class="keyword">FROM</span> courses</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">class</span></span><br><span class="line"><span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(<span class="keyword">DISTINCT</span> student) &gt;= <span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<h1 id="597-Friend-Requests-I-Overall-Acceptance-Rate"><a href="#597-Friend-Requests-I-Overall-Acceptance-Rate" class="headerlink" title="597. Friend Requests I: Overall Acceptance Rate"></a>597. Friend Requests I: Overall Acceptance Rate</h1><p>In social network like Facebook or Twitter, people send friend requests and accept others’ requests as well. Now given two tables as below:</p>
<p>Table: <code>friend_request</code></p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> sender_id </span>|<span class="string"> send_to_id </span>|<span class="string">request_date</span>|</span><br><span class="line">|<span class="string">-----------</span>|<span class="string">------------</span>|<span class="string">------------</span>|</span><br><span class="line">|<span class="string"> 1         </span>|<span class="string"> 2          </span>|<span class="string"> 2016_06-01 </span>|</span><br><span class="line">|<span class="string"> 1         </span>|<span class="string"> 3          </span>|<span class="string"> 2016_06-01 </span>|</span><br><span class="line">|<span class="string"> 1         </span>|<span class="string"> 4          </span>|<span class="string"> 2016_06-01 </span>|</span><br><span class="line">|<span class="string"> 2         </span>|<span class="string"> 3          </span>|<span class="string"> 2016_06-02 </span>|</span><br><span class="line">|<span class="string"> 3         </span>|<span class="string"> 4          </span>|<span class="string"> 2016-06-09 </span>|</span><br></pre></td></tr></table></figure>

<p>Table: <code>request_accepted</code></p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> requester_id </span>|<span class="string"> accepter_id </span>|<span class="string">accept_date </span>|</span><br><span class="line">|<span class="string">--------------</span>|<span class="string">-------------</span>|<span class="string">------------</span>|</span><br><span class="line">|<span class="string"> 1            </span>|<span class="string"> 2           </span>|<span class="string"> 2016_06-03 </span>|</span><br><span class="line">|<span class="string"> 1            </span>|<span class="string"> 3           </span>|<span class="string"> 2016-06-08 </span>|</span><br><span class="line">|<span class="string"> 2            </span>|<span class="string"> 3           </span>|<span class="string"> 2016-06-08 </span>|</span><br><span class="line">|<span class="string"> 3            </span>|<span class="string"> 4           </span>|<span class="string"> 2016-06-09 </span>|</span><br><span class="line">|<span class="string"> 3            </span>|<span class="string"> 4           </span>|<span class="string"> 2016-06-10 </span>|</span><br></pre></td></tr></table></figure>

<p>Write a query to find the overall acceptance rate of requests rounded to 2 decimals, which is the number of acceptance divide the number of requests.</p>
<p>For the sample data above, your query should return the following result.</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string">accept_rate</span>|</span><br><span class="line">|<span class="string">-----------</span>|</span><br><span class="line">|<span class="string">       0.80</span>|</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">ROUND</span>(</span><br><span class="line">            <span class="keyword">IFNULL</span>(</span><br><span class="line">            (<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> requester_id, accepter_id</span><br><span class="line">                                   <span class="keyword">FROM</span> request_accepted) <span class="keyword">AS</span> A)</span><br><span class="line">            /</span><br><span class="line">            (<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> sender_id, send_to_id</span><br><span class="line">                                   <span class="keyword">FROM</span> friend_request) <span class="keyword">AS</span> B),<span class="number">0</span>),<span class="number">2</span>)</span><br><span class="line">            <span class="keyword">AS</span> accept_rate；</span><br></pre></td></tr></table></figure>

<h1 id="601-Human-Traffic-of-Stadium"><a href="#601-Human-Traffic-of-Stadium" class="headerlink" title="601. Human Traffic of Stadium"></a>601. Human Traffic of Stadium</h1><p>X city built a new stadium, each day many people visit it and the stats are saved as these columns: id, visit_date, people</p>
<p>Please write a query to display the records which have 3 or more consecutive rows and the amount of people more than 100(inclusive).</p>
<p>For example, the table <code>stadium</code>:</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">+------+------------+-----------+</span><br><span class="line">| id   | visit_date | people    |</span><br><span class="line">+------+------------+-----------+</span><br><span class="line">| <span class="number">1</span>    | <span class="number">2017</span><span class="number">-01</span><span class="number">-01</span> | <span class="number">10</span>        |</span><br><span class="line">| <span class="number">2</span>    | <span class="number">2017</span><span class="number">-01</span><span class="number">-02</span> | <span class="number">109</span>       |</span><br><span class="line">| <span class="number">3</span>    | <span class="number">2017</span><span class="number">-01</span><span class="number">-03</span> | <span class="number">150</span>       |</span><br><span class="line">| <span class="number">4</span>    | <span class="number">2017</span><span class="number">-01</span><span class="number">-04</span> | <span class="number">99</span>        |</span><br><span class="line">| <span class="number">5</span>    | <span class="number">2017</span><span class="number">-01</span><span class="number">-05</span> | <span class="number">145</span>       |</span><br><span class="line">| <span class="number">6</span>    | <span class="number">2017</span><span class="number">-01</span><span class="number">-06</span> | <span class="number">1455</span>      |</span><br><span class="line">| <span class="number">7</span>    | <span class="number">2017</span><span class="number">-01</span><span class="number">-07</span> | <span class="number">199</span>       |</span><br><span class="line">| <span class="number">8</span>    | <span class="number">2017</span><span class="number">-01</span><span class="number">-08</span> | <span class="number">188</span>       |</span><br><span class="line">+------+------------+-----------+</span><br></pre></td></tr></table></figure>

<p>For the sample data above, the output is:</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="code">+------+</span>------------<span class="code">+-----------+</span></span><br><span class="line">| id   | visit<span class="emphasis">_date | people    |</span></span><br><span class="line"><span class="emphasis">+------+------------+-----------+</span></span><br><span class="line"><span class="emphasis">| 5    | 2017-01-05 | 145       |</span></span><br><span class="line"><span class="emphasis">| 6    | 2017-01-06 | 1455      |</span></span><br><span class="line"><span class="emphasis">| 7    | 2017-01-07 | 199       |</span></span><br><span class="line"><span class="emphasis">| 8    | 2017-01-08 | 188       |</span></span><br><span class="line"><span class="emphasis">+------+------------+-----------+</span></span><br></pre></td></tr></table></figure>

<p><strong>Note</strong>:<br>Each day only have one row record, and the dates are increasing with id increasing.</p>
<p><strong>Solution:</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> t1.*</span><br><span class="line"><span class="keyword">FROM</span> stadium t1, stadium t2, stadium t3</span><br><span class="line"><span class="keyword">WHERE</span> t1.people &gt;= <span class="number">100</span> <span class="keyword">AND</span> t2.people &gt;= <span class="number">100</span> <span class="keyword">AND</span> t3.people &gt;= <span class="number">100</span></span><br><span class="line">      <span class="keyword">AND</span>(</span><br><span class="line">          (t1.id - t2.id = <span class="number">1</span> <span class="keyword">AND</span> t1.id - t3.id = <span class="number">2</span> <span class="keyword">AND</span> t2.id - t3.id =<span class="number">1</span>)  <span class="comment">-- t1, t2, t3</span></span><br><span class="line">          <span class="keyword">OR</span></span><br><span class="line">          (t2.id - t1.id = <span class="number">1</span> <span class="keyword">AND</span> t2.id - t3.id = <span class="number">2</span> <span class="keyword">AND</span> t1.id - t3.id =<span class="number">1</span>) <span class="comment">-- t2, t1, t3</span></span><br><span class="line">          <span class="keyword">OR</span></span><br><span class="line">          (t3.id - t2.id = <span class="number">1</span> <span class="keyword">AND</span> t2.id - t1.id =<span class="number">1</span> <span class="keyword">AND</span> t3.id - t1.id = <span class="number">2</span>) <span class="comment">-- t3, t2, t1</span></span><br><span class="line">         )</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> t1.id;</span><br></pre></td></tr></table></figure>

<h1 id="602-Friend-Requests-II-Who-Has-the-Most-Friends"><a href="#602-Friend-Requests-II-Who-Has-the-Most-Friends" class="headerlink" title="602. Friend Requests II: Who Has the Most Friends"></a>602. Friend Requests II: Who Has the Most Friends</h1><div class="note info">
            <p>Write a query to find the the people who has most friends and the most friends number. For the sample data above, the result is:</p>
          </div>

<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">|<span class="string"> id </span>|<span class="string"> num </span>|</span><br><span class="line">|<span class="string">----</span>|<span class="string">-----</span>|</span><br><span class="line">|<span class="string"> 3  </span>|<span class="string"> 3   </span>|</span><br></pre></td></tr></table></figure>

<p><strong>Note:</strong></p>
<ul>
<li>It is guaranteed there is only 1 people having the most friends.</li>
<li>The friend request could only been accepted once, which mean there is no multiple records with the same requester_id and accepter_id value.</li>
</ul>
<p><strong>Explanation:</strong></p>
<ul>
<li>The person with id ‘3’ is a friend of people ‘1’, ‘2’ and ‘4’, so he has 3 friends in total, which is the most number than any others.</li>
</ul>
<p><strong>Follow-up:</strong></p>
<ul>
<li>In the real world, multiple people could have the same most number of friends, can you find all these people in this case?</li>
</ul>
<p><strong>Solution</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/* MySQL*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> ids <span class="keyword">AS</span> <span class="keyword">id</span>, <span class="keyword">num</span></span><br><span class="line"><span class="keyword">FROM</span> (<span class="keyword">SELECT</span> ids, <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> <span class="keyword">num</span></span><br><span class="line">      <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> requester_id <span class="keyword">AS</span> ids <span class="keyword">FROM</span> request_accepted</span><br><span class="line">            <span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line">            <span class="keyword">SELECT</span> accepter_id <span class="keyword">FROM</span> request_accepted) <span class="keyword">AS</span> temp1</span><br><span class="line">      <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="number">1</span>) <span class="keyword">AS</span> temp2</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">num</span> <span class="keyword">DESC</span></span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">1</span></span><br><span class="line">;</span><br></pre></td></tr></table></figure>

<p><strong>Follow up</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Union"><a href="#Union" class="headerlink" title="Union"></a>Union</h2><p><a href="https://leetcode.com/problems/friend-requests-ii-who-has-the-most-friends/" target="_blank" rel="noopener">602. Friend Requests II: Who Has the Most Friends</a></p>
<h2 id="Concecutive-Problem"><a href="#Concecutive-Problem" class="headerlink" title="Concecutive Problem"></a>Concecutive Problem</h2><p><a href="https://leetcode.com/problems/human-traffic-of-stadium/" target="_blank" rel="noopener">601. Human Traffic of Stadium</a></p>
<h2 id="Working-with-NULL-Values"><a href="#Working-with-NULL-Values" class="headerlink" title="Working with NULL Values"></a><a href="https://dev.mysql.com/doc/refman/5.7/en/working-with-null.html" target="_blank" rel="noopener">Working with NULL Values</a></h2><p><a href="https://leetcode.com/problems/employee-bonus/" target="_blank" rel="noopener">577. Employee Bonus</a><br><a href="https://leetcode.com/problems/find-customer-referee/submissions/" target="_blank" rel="noopener">584. Find Customer Referee</a></p>
<h2 id="CONCAT"><a href="#CONCAT" class="headerlink" title="CONCAT"></a>CONCAT</h2><p><a href="https://leetcode.com/problems/investments-in-2016/" target="_blank" rel="noopener">585. Investments in 2016</a></p>
<h2 id="LIMIT-or-TOP"><a href="#LIMIT-or-TOP" class="headerlink" title="LIMIT or TOP"></a>LIMIT or TOP</h2><p><a href="https://leetcode.com/problems/winning-candidate/" target="_blank" rel="noopener">574. Winning Candidate</a></p>
<h2 id="GROUP-BY"><a href="#GROUP-BY" class="headerlink" title="GROUP BY"></a>GROUP BY</h2><p><a href="https://leetcode.com/problems/game-play-analysis-i/" target="_blank" rel="noopener">511. Game Play Analysis I</a><br><a href="https://leetcode.com/problems/count-student-number-in-departments/" target="_blank" rel="noopener">580. Count Student Number in Departments</a></p>
<h2 id="JOIN-on-Multiple-Condition"><a href="#JOIN-on-Multiple-Condition" class="headerlink" title="JOIN on Multiple Condition"></a>JOIN on Multiple Condition</h2><p><a href="https://leetcode.com/problems/employees-earning-more-than-their-managers/" target="_blank" rel="noopener">181. Employees Earning More Than Their Managers</a><br><a href="https://leetcode.com/problems/rising-temperature/" target="_blank" rel="noopener">197. Rising Temperature</a><br><a href="https://leetcode.com/problems/active-businesses/" target="_blank" rel="noopener">1126. Active Businesses</a></p>
<h2 id="Having"><a href="#Having" class="headerlink" title="Having"></a>Having</h2><p><a href="https://leetcode.com/problems/duplicate-emails/" target="_blank" rel="noopener">182. Duplicate Emails</a><br><a href="https://leetcode.com/problems/customer-placing-the-largest-number-of-orders/" target="_blank" rel="noopener">586. Customer Placing the Largest Number of Orders</a></p>
<h2 id="Where-IN-OR-Where-NOT-IN"><a href="#Where-IN-OR-Where-NOT-IN" class="headerlink" title="Where IN OR Where NOT IN"></a>Where IN OR Where NOT IN</h2><p>Medium<br><a href="https://leetcode.com/problems/customers-who-never-order/" target="_blank" rel="noopener">183. Customers Who Never Order</a><br><a href="https://leetcode.com/problems/department-highest-salary/" target="_blank" rel="noopener">184. Department Highest Salary</a><br><a href="https://leetcode.com/problems/game-play-analysis-ii/" target="_blank" rel="noopener">512. Game Play Analysis II</a><br><a href="https://leetcode.com/problems/managers-with-at-least-5-direct-reports/" target="_blank" rel="noopener">570. Managers with at Least 5 Direct Reports</a></p>
<h2 id="WHERE-OR"><a href="#WHERE-OR" class="headerlink" title="WHERE OR"></a>WHERE OR</h2><p>[595. Big Countries](596. Classes More Than 5 Students)</p>
<h2 id="Self-Join"><a href="#Self-Join" class="headerlink" title="Self Join"></a>Self Join</h2><p>Medium<br><a href="https://leetcode.com/problems/consecutive-numbers/" target="_blank" rel="noopener">180. Consecutive Numbers</a></p>
<h2 id="Delete"><a href="#Delete" class="headerlink" title="Delete"></a>Delete</h2><p><a href="https://leetcode.com/problems/delete-duplicate-emails/" target="_blank" rel="noopener">196. Delete Duplicate Emails</a></p>
<h2 id="Window-Function"><a href="#Window-Function" class="headerlink" title="Window Function"></a>Window Function</h2><p>Medium:<br><a href="https://leetcode.com/problems/rank-scores/" target="_blank" rel="noopener">178. Rank Scores</a><br><a href="https://leetcode.com/problems/game-play-analysis-iii/" target="_blank" rel="noopener">534. Game Play Analysis III</a></p>
<p>Hard:<br><a href="https://leetcode.com/problems/department-top-three-salaries/" target="_blank" rel="noopener">185. Department Top Three Salaries</a><br><a href="https://leetcode.com/problems/median-employee-salary/" target="_blank" rel="noopener">569. Median Employee Salary</a><br><a href="https://leetcode.com/problems/find-cumulative-salary-of-an-employee/" target="_blank" rel="noopener">579. Find Cumulative Salary of an Employee</a><br><a href="https://leetcode.com/problems/median-employee-salary/" target="_blank" rel="noopener">569. Median Employee Salary</a></p>
<h2 id="Rate"><a href="#Rate" class="headerlink" title="Rate"></a>Rate</h2><p>Easy:<br><a href="https://leetcode.com/problems/friend-requests-i-overall-acceptance-rate/" target="_blank" rel="noopener">597. Friend Requests I: Overall Acceptance Rate</a></p>
<p>Hard:<br><a href="https://leetcode.com/problems/trips-and-users/" target="_blank" rel="noopener">262. Trips and Users</a><br><a href="https://leetcode.com/problems/game-play-analysis-v/" target="_blank" rel="noopener">1097. Game Play Analysis V</a></p>
<p>Medium:<br><a href="https://leetcode.com/problems/game-play-analysis-iv/" target="_blank" rel="noopener">550. Game Play Analysis IV</a><br><a href="https://leetcode.com/problems/get-highest-answer-rate-question/" target="_blank" rel="noopener">578. Get Highest Answer Rate Question</a></p>
<h1 id="IFNULL"><a href="#IFNULL" class="headerlink" title="IFNULL"></a>IFNULL</h1><p><a href="https://leetcode.com/problems/friend-requests-i-overall-acceptance-rate/" target="_blank" rel="noopener">597. Friend Requests I: Overall Acceptance Rate</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">val</span><span class="params">(a)</span>:</span></span><br><span class="line">    print(a)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

    </div>

    
    
    
        
      
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>Shuo Jin</li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="http://yoursite.com/2019/08/06/leetcodSQL/" title="Leetcode SQL Summary">http://yoursite.com/2019/08/06/leetcodSQL/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.</li>
</ul>
</div>

      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/SQL-Leetcode-Database/" rel="tag"><i class="fa fa-tag"> SQL, Leetcode, Database </i></a>

            
          </div>
        

        
  <div class="post-widgets">
    <div class="social-share">
      
        
          
        

        <div class="likely">
          
            <div class="twitter">Tweet</div>
          
            <div class="facebook">Share</div>
          
            <div class="linkedin">Link</div>
          
            <div class="gplus">Plus</div>
          
            <div class="vkontakte">Share</div>
          
            <div class="odnoklassniki">Class</div>
          
            <div class="telegram">Send</div>
          
            <div class="whatsapp">Send</div>
          
            <div class="pinterest">Pin</div>
          
        </div>
      
      
    </div>
  
  </div>

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2019/08/07/ABtest3/" rel="prev" title="Udacity A/B Testing Summary Lesson 3 - Metrics">
                  Udacity A/B Testing Summary Lesson 3 - Metrics <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">

          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/images/avatar.gif"
      alt="Shuo Jin">
  <p class="site-author-name" itemprop="name">Shuo Jin</p>
  <div class="site-description motion-element" itemprop="description"></div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        
        
          
        
          
        
          
        
          
        
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">tags</span>
        </a>
      </div>
    
  </nav>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://github.com/AdadaBdada" title="GitHub &rarr; https://github.com/AdadaBdada" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="/sjin6@stevens.edu" title="E-Mail &rarr; sjin6@stevens.edu"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
    
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="https://www.linkedin.com/in/shuo-jin-95062613a/" title="LinkedIn &rarr; https://www.linkedin.com/in/shuo-jin-95062613a/" rel="noopener" target="_blank"><i class="fa fa-fw fa-linkedin"></i>LinkedIn</a>
      </span>
    
  </div>
  <div class="cc-license motion-element" itemprop="license">
    
  
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>




        </div>
      </div>
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#178-Combine-Two-Tablesn-Easy"><span class="nav-text">178. Combine Two Tablesn Easy</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#176-Second-Highest-Salary"><span class="nav-text">176. Second Highest Salary</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#177-Nth-Highest-Salary"><span class="nav-text">177. Nth Highest Salary</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#178-Rank-Scores"><span class="nav-text">178. Rank Scores</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#180-Consecutive-Numbers"><span class="nav-text">180. Consecutive Numbers</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#181-Employees-Earning-More-Than-Their-Managers"><span class="nav-text">181. Employees Earning More Than Their Managers</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#182-Duplicate-Emails"><span class="nav-text">182. Duplicate Emails</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#183-Customers-Who-Never-Order"><span class="nav-text">183. Customers Who Never Order</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#184-Department-Highest-Salary"><span class="nav-text">184. Department Highest Salary</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#185-Department-Top-Three-Salaries"><span class="nav-text">185. Department Top Three Salaries</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#196-Delete-Duplicate-Emails"><span class="nav-text">196. Delete Duplicate Emails</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#197-Rising-Temperature"><span class="nav-text">197. Rising Temperature</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#262-Trips-and-Users"><span class="nav-text">262. Trips and Users</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#511-Game-Play-Analysis-I"><span class="nav-text">511. Game Play Analysis I</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#512-Game-Play-Analysis-II"><span class="nav-text">512. Game Play Analysis II</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#534-Game-Play-Analysis-III"><span class="nav-text">534. Game Play Analysis III</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#550-Game-Play-Analysis-IV"><span class="nav-text">550. Game Play Analysis IV</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1097-Game-Play-Analysis-V"><span class="nav-text">1097. Game Play Analysis V</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#569-Median-Employee-Salary"><span class="nav-text">569. Median Employee Salary</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#570-Managers-with-at-Least-5-Direct-Reports"><span class="nav-text">570. Managers with at Least 5 Direct Reports</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#571-Find-Median-Given-Frequency-of-Numbers"><span class="nav-text">571. Find Median Given Frequency of Numbers</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#574-Winning-Candidate"><span class="nav-text">574. Winning Candidate</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#577-Employee-Bonus"><span class="nav-text">577. Employee Bonus</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#578-Get-Highest-Answer-Rate-Question"><span class="nav-text">578. Get Highest Answer Rate Question</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#579-Find-Cumulative-Salary-of-an-Employee"><span class="nav-text">579. Find Cumulative Salary of an Employee</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#580-Count-Student-Number-in-Departments"><span class="nav-text">580. Count Student Number in Departments</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#584-Find-Customer-Referee"><span class="nav-text">584. Find Customer Referee</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#585-Investments-in-2016"><span class="nav-text">585. Investments in 2016</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#586-Customer-Placing-the-Largest-Number-of-Orders"><span class="nav-text">586. Customer Placing the Largest Number of Orders</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#595-Big-Countries"><span class="nav-text">595. Big Countries</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#596-Classes-More-Than-5-Students"><span class="nav-text">596. Classes More Than 5 Students</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#597-Friend-Requests-I-Overall-Acceptance-Rate"><span class="nav-text">597. Friend Requests I: Overall Acceptance Rate</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#601-Human-Traffic-of-Stadium"><span class="nav-text">601. Human Traffic of Stadium</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#602-Friend-Requests-II-Who-Has-the-Most-Friends"><span class="nav-text">602. Friend Requests II: Who Has the Most Friends</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Union"><span class="nav-text">Union</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Concecutive-Problem"><span class="nav-text">Concecutive Problem</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Working-with-NULL-Values"><span class="nav-text">Working with NULL Values</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CONCAT"><span class="nav-text">CONCAT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LIMIT-or-TOP"><span class="nav-text">LIMIT or TOP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GROUP-BY"><span class="nav-text">GROUP BY</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#JOIN-on-Multiple-Condition"><span class="nav-text">JOIN on Multiple Condition</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Having"><span class="nav-text">Having</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Where-IN-OR-Where-NOT-IN"><span class="nav-text">Where IN OR Where NOT IN</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WHERE-OR"><span class="nav-text">WHERE OR</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Self-Join"><span class="nav-text">Self Join</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Delete"><span class="nav-text">Delete</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Window-Function"><span class="nav-text">Window Function</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Rate"><span class="nav-text">Rate</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#IFNULL"><span class="nav-text">IFNULL</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Shuo Jin</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
      <span class="post-meta-item-text">Symbols count total: </span>
    
    <span title="Symbols count total">64k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">Reading time total &asymp;</span>
    
    <span title="Reading time total">58 mins.</span>
</div>
  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v7.3.0</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="Total Visitors">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  
    <span class="post-meta-divider">|</span>
  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="Total Views">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>








        
      </div>
    </footer>
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
      </div>

    
  
<script src="//cdn.jsdelivr.net/npm/ilyabirman-likely@2/release/likely.js"></script>


  </div>

  
    
    
  
    
    
  
    
    
  
    
  
  <script color='96,96,96' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/jquery/index.js?v=3.4.1"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  <script defer src="/lib/three/three.min.js"></script>
  <script defer src="/lib/three/three-waves.min.js"></script>
  <script defer src="/lib/three/canvas_lines.min.js"></script>
  <script defer src="/lib/three/canvas_sphere.min.js"></script>

<script src="/js/utils.js?v=7.3.0"></script><script src="/js/motion.js?v=7.3.0"></script>

<script src="/js/schemes/muse.js?v=7.3.0"></script>



<script src="/js/next-boot.js?v=7.3.0"></script>




  















  <script src="/js/local-search.js?v=7.3.0"></script>














  

  
    
      
<script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script>
<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML', () => {
    MathJax.Hub.Typeset();
  }, window.MathJax);
</script>

    
  

  

  


  
  <script src="/js/scrollspy.js?v=7.3.0"></script><script src="/js/post-details.js?v=7.3.0"></script>


</body>
</html>
